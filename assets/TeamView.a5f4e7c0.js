import{l as h,o as d,c as u,a as s,w as a,V as p,bg as V,S as f,d as n,i as x,k as C,b as i,F,n as T,b8 as z,t as _,bf as U,f as b,h as g,g as y}from"./index.89256b45.js";import{d as S,c as j,V as A,e as B,b as D}from"./VDialog.8dfed00a.js";import{V as N}from"./VTable.9fd3b2fe.js";import{V as q}from"./VForm.eb7aa19f.js";import{a as E}from"./VTextField.f16bee7e.js";import{a as I,V as v}from"./VTextarea.f4ca7fe6.js";import"./createSimpleFunctional.baa32468.js";import"./VAvatar.118222b3.js";import"./scopeId.a0be6a54.js";import"./form.dd879711.js";import"./VOverlay.89393687.js";import"./VChip.70ad6a18.js";const $={id:"admin-designers"},L=i("h1",{class:"text-center my-2"},"\u5718\u968A\u7BA1\u7406",-1),M=g("mdi-plus"),R=i("thead",null,[i("tr",null,[i("th",{class:"text-center text-h6"},"\u7DE8\u865F"),i("th",{class:"text-center text-h6"},"\u982D\u50CF"),i("th",{class:"text-center text-h6"},"\u59D3\u540D"),i("th",{class:"text-center text-h6"},"\u7C21\u4ECB"),i("th",{class:"text-center text-h6"},"\u767C\u4F48"),i("th",{class:"text-center text-h6"},"\u7DE8\u8F2F"),i("th",{class:"text-center text-h6"},"\u522A\u9664")])],-1),G={class:"text-center"},H={class:"text-center"},J={class:"text-center"},K={key:0,class:"text-center"},O={key:1,class:"text-center"},P=i("td",{class:"text-center"},"\u7DE8\u8F2F",-1),Q=i("td",{class:"text-center"},"\u522A\u9664",-1),W={key:1},X=i("td",{class:"text-center text-h6",colspan:"7"},"\u5C1A\u7121\u8A2D\u8A08\u5E2B",-1),Y=[X],Z={class:"text-h5"},ee=g("\u78BA\u5B9A"),te=g("\u53D6\u6D88"),he={__name:"TeamView",setup(se){const r=h([]),t=h({_id:"",name:"",description:"",avatar:"",portfolio:[],publish:!1,idx:-1,dialog:!1,valid:!1,submitting:!1}),c=h({required(o){return!!o||"\u5FC5\u586B"},size(o){var e,l,m;return!o||!o.length||((l=(e=o[0])==null?void 0:e.type)==null?void 0:l.includes("image"))&&((m=o[0])==null?void 0:m.size)<1024*1024||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26"}}),w=(o,e)=>{t._id=o,e>-1?(t.name=r[e].name,t.description=r[e].description,t.publish=r[e].publish):(t.name="",t.description="",t.publish=!1),t.avatar=[],t.portfolio=[],t.idx=e,t.dialog=!0,t.valid=!1,t.submitting=!1},k=async()=>{if(!t.valid)return;t.submitting=!0;const o=new FormData;for(const e in t)if(!["_id","idx","dialog","valid","submitting"].includes(e))if(e==="avatar")o.append(e,t[e][0]);else if(e==="portfolio")for(const l in t[e])o.append(e,l);else o.append(e,t[e]);try{if(t._id.length===0){const{data:e}=await V.post("/designers",o);r.push(e.result),f.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:e}=await V.patch("/designers/"+t._id,o);console.log(o.name),r[t.idx]=e.result,f.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}t.dialog=!1}catch(e){f.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}t.submitting=!1};return(async()=>{try{const{data:o}=await V.get("/designers/all");r.push(...o.result)}catch(o){console.log(o),f.fire({icon:"error",title:"\u5931\u6557",text:o.isAxiosError?o.response.data.message:o.message})}})(),(o,e)=>(d(),u("div",$,[s(p,{class:"justify-center"},{default:a(()=>[s(n,{cols:"9"},{default:a(()=>[L]),_:1}),s(n,{cols:"9"},{default:a(()=>[s(p,{class:"justify-end align-center",style:{height:"150px"}},{default:a(()=>[s(x,{icon:"",variant:"text",onClick:e[0]||(e[0]=l=>w("",-1))},{default:a(()=>[s(C,{color:"green lighten-2"},{default:a(()=>[M]),_:1})]),_:1})]),_:1})]),_:1}),s(n,{cols:"9"},{default:a(()=>[s(N,null,{default:a(()=>[R,i("tbody",null,[r.length>0?(d(!0),u(F,{key:0},T(r,(l,m)=>(d(),u("tr",{key:l._id},[i("td",G,_(m+1),1),i("td",null,[s(b,{src:l.avatar},null,8,["src"])]),i("td",H,_(l.name),1),i("td",J,_(l.description),1),l.publish===!0?(d(),u("td",K,"\u5DF2\u767C\u4F48")):y("",!0),l.publish===!1?(d(),u("td",O,"\u672A\u767C\u4F48")):y("",!0),P,Q]))),128)):(d(),u("tr",W,Y))])]),_:1})]),_:1})]),_:1}),s(S,{modelValue:t.dialog,"onUpdate:modelValue":e[7]||(e[7]=l=>t.dialog=l),persistent:""},{default:a(()=>[s(q,{modelValue:t.valid,"onUpdate:modelValue":e[6]||(e[6]=l=>t.valid=l),onSubmit:z(k,["prevent"])},{default:a(()=>[s(j,null,{default:a(()=>[s(A,{class:"text-center my-4"},{default:a(()=>[i("div",Z,_(t._id.length>0?"\u7DE8\u8F2F\u8A2D\u8A08\u5E2B":"\u65B0\u589E\u8A2D\u8A08\u5E2B"),1)]),_:1}),s(B,null,{default:a(()=>[s(U,null,{default:a(()=>[s(p,{class:"justify-center"},{default:a(()=>[s(n,{cols:"9"},{default:a(()=>[s(E,{modelValue:t.name,"onUpdate:modelValue":e[1]||(e[1]=l=>t.name=l),label:"\u540D\u7A31",rules:[c.required]},null,8,["modelValue","rules"])]),_:1}),s(n,{cols:"9"},{default:a(()=>[s(I,{modelValue:t.description,"onUpdate:modelValue":e[2]||(e[2]=l=>t.description=l),label:"\u7C21\u4ECB",rules:[c.required]},null,8,["modelValue","rules"])]),_:1}),s(n,{cols:"9"},{default:a(()=>[s(v,{modelValue:t.avatar,"onUpdate:modelValue":e[3]||(e[3]=l=>t.avatar=l),"show-size":"",accept:"avatar/*",label:"\u982D\u50CF","prepend-icon":"",outlined:"",rules:[c.size]},null,8,["modelValue","rules"])]),_:1}),s(n,{cols:"9"},{default:a(()=>[s(v,{modelValue:t.portfolio,"onUpdate:modelValue":e[4]||(e[4]=l=>t.portfolio=l),"show-size":"",accept:"portfolio/*",label:"\u4F5C\u54C1\u96C6","prepend-icon":"",outlined:"",rules:[c.size]},null,8,["modelValue","rules"])]),_:1}),s(n,{cols:"9"},{default:a(()=>[s(b,{src:t.portfolio},null,8,["src"])]),_:1})]),_:1})]),_:1})]),_:1}),s(D,null,{default:a(()=>[s(p,{class:"justify-center"},{default:a(()=>[s(x,{type:"submit",color:"primary",loading:t.submitting},{default:a(()=>[ee]),_:1},8,["loading"]),s(x,{color:"error",onClick:e[5]||(e[5]=l=>t.dialog=!1),disabled:t.submitting},{default:a(()=>[te]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1},8,["modelValue"])]))}};export{he as default};
