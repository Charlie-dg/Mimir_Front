import{B as ne,A as _e,x as V,G as se,am as oe,a as t,a9 as z,I as be,an as ke,aq as Ce,v as ve,r as b,F as A,bh as ce,aA as ae,aH as we,bi as Se,Z as E,y as Fe,K as de,a6 as Be,bj as Pe,ad as $e,aY as ze,l as Y,o as D,c as H,w as o,V as T,bg as te,S as Z,d as B,i as M,k as le,b as c,n as Ie,b8 as Re,t as J,bf as Ae,h as L,f as Ne,g as fe}from"./index.1abab4fd.js";import{d as Ue,c as De,V as He,e as Te,b as je}from"./VDialog.6ae4a7ab.js";import{V as Ge}from"./VTable.d53087bb.js";import{V as qe}from"./VForm.177f6fbe.js";import{m as ie,f as re,b as ue,c as ge,d as he,e as xe,g as Ve,a as me}from"./VTextField.de84ebcb.js";import{m as Ee,f as Me,c as Le,b as Ke,a as Oe}from"./VSelect.4227a30f.js";import{f as pe}from"./form.612ffd7c.js";import"./createSimpleFunctional.c0a6c7b6.js";import"./VAvatar.39d795f4.js";import"./scopeId.ec03e723.js";import"./VOverlay.6f1acc69.js";import"./VList.284b03ec.js";import"./VDivider.18abc35e.js";const Ye=ne({name:"VCheckbox",inheritAttrs:!1,props:{...ie(),...Ee()},setup(e,p){let{attrs:d,slots:l}=p;const u=_e(),f=V(()=>e.id||`checkbox-${u}`);return se(()=>{const[v,I]=oe(d),[s,a]=re(e),[n,g]=Me(e);return t(ue,z({class:"v-checkbox"},v,s,{id:f.value}),{...l,default:P=>{let{id:k,isDisabled:y,isReadonly:x}=P;return t(Le,z(n,{id:k.value,disabled:y.value,readonly:x.value},I),l)}})}),{}}});const Ze=ne({name:"VFileInput",inheritAttrs:!1,props:{chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,hint:String,persistentHint:Boolean,placeholder:String,showSize:{type:[Boolean,Number],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(e)},...ie(),prependIcon:{type:be,default:"$file"},modelValue:{type:Array,default:()=>[],validator:e=>ke(e).every(p=>p!=null&&typeof p=="object")},...ge({clearable:!0})},emits:{"click:clear":e=>!0,"click:control":e=>!0,"update:modelValue":e=>!0},setup(e,p){let{attrs:d,emit:l,slots:u}=p;const{t:f}=Ce(),v=ve(e,"modelValue"),I=V(()=>typeof e.showSize!="boolean"?e.showSize:void 0),s=V(()=>{var r;return((r=v.value)!=null?r:[]).reduce((m,h)=>{let{size:i=0}=h;return m+i},0)}),a=V(()=>ce(s.value,I.value)),n=V(()=>{var r;return((r=v.value)!=null?r:[]).map(m=>{const{name:h="",size:i=0}=m;return e.showSize?`${h} (${ce(i,I.value)})`:h})}),g=V(()=>{var r,m;const h=(r=(m=v.value)==null?void 0:m.length)!=null?r:0;return e.showSize?f(e.counterSizeString,h,a.value):f(e.counterString,h)}),P=b(),k=b(),y=b(!1),x=b(),j=V(()=>e.messages.length?e.messages:e.persistentHint?e.hint:"");function G(){if(x.value!==document.activeElement){var r;(r=x.value)==null||r.focus()}y.value||(y.value=!0)}function K(r){var m;(m=x.value)==null||m.click(),l("click:control",r)}function Q(r){r.stopPropagation(),G(),ae(()=>{v.value=[],x!=null&&x.value&&(x.value.value=""),l("click:clear",r)})}return se(()=>{const r=!!(u.counter||e.counter),m=!!(r||u.details),[h,i]=oe(d),[{modelValue:C,..._}]=re(e),[w]=he(e);return t(ue,z({ref:P,modelValue:v.value,"onUpdate:modelValue":S=>v.value=S,class:"v-file-input"},h,_,{"onClick:prepend":K,messages:j.value}),{...u,default:S=>{let{isDisabled:$,isDirty:N,isReadonly:R,isValid:U}=S;return t(xe,z({ref:k,"prepend-icon":e.prependIcon,"onClick:control":K,"onClick:clear":Q},w,{active:N.value||y.value,dirty:N.value,focused:y.value,error:U.value===!1}),{...u,default:O=>{let{props:{class:W,...X}}=O;return t(A,null,[t("input",z({ref:x,type:"file",readonly:R.value,disabled:$.value,multiple:e.multiple,name:e.name,onClick:F=>{F.stopPropagation(),G()},onChange:F=>{var q;if(!F.target)return;const ee=F.target;v.value=[...(q=ee.files)!=null?q:[]]},onFocus:G,onBlur:()=>y.value=!1},X,i),null),v.value.length>0&&t("div",{class:W},[u.selection?u.selection({fileNames:n.value,totalBytes:s.value,totalBytesReadable:a.value}):e.chips?n.value.map(F=>t(Ke,{key:F,size:"small",color:e.color},{default:()=>[F]})):n.value.join(", ")])])}})},details:m?S=>{var $;return t(A,null,[($=u.details)==null?void 0:$.call(u,S),r&&t(A,null,[t("span",null,null),t(Ve,{active:!!v.value.length,value:g.value},u.counter)])])}:void 0})}),pe({},P,k,x)}});const Je=ne({name:"VTextarea",directives:{Intersect:we},inheritAttrs:!1,props:{autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,hint:String,persistentHint:Boolean,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,...ie(),...ge()},emits:{"click:clear":e=>!0,"click:control":e=>!0,"update:modelValue":e=>!0},setup(e,p){let{attrs:d,emit:l,slots:u}=p;const f=ve(e,"modelValue"),v=V(()=>typeof e.counterValue=="function"?e.counterValue(f.value):(f.value||"").toString().length),I=V(()=>{if(d.maxlength)return d.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function s(i,C){var _,w;!e.autofocus||!i||(_=C[0].target)==null||(w=_.focus)==null||w.call(_)}const a=b(),n=b(),g=b(!1),P=b(""),k=b(),y=V(()=>g.value||e.persistentPlaceholder),x=V(()=>e.messages.length?e.messages:y.value||e.persistentHint?e.hint:"");function j(){if(k.value!==document.activeElement){var i;(i=k.value)==null||i.focus()}g.value||(g.value=!0)}function G(i){j(),l("click:control",i)}function K(i){i.stopPropagation(),j(),ae(()=>{f.value="",l("click:clear",i)})}function Q(i){f.value=i.target.value}const r=b();function m(){!e.autoGrow||ae(()=>{if(!r.value||!n.value)return;const i=getComputedStyle(r.value),C=getComputedStyle(n.value.$el),_=parseFloat(i.getPropertyValue("--v-field-padding-top"))+parseFloat(i.getPropertyValue("--v-input-padding-top"))+parseFloat(i.getPropertyValue("--v-field-padding-bottom")),w=r.value.scrollHeight,S=parseFloat(i.lineHeight),$=Math.max(parseFloat(e.rows)*S+_,parseFloat(C.getPropertyValue("--v-input-control-height"))),N=parseFloat(e.maxRows)*S+_||1/0;P.value=$e(ze(w!=null?w:0,$,N))})}Se(m),E(f,m),E(()=>e.rows,m),E(()=>e.maxRows,m),E(()=>e.density,m);let h;return E(r,i=>{if(i)h=new ResizeObserver(m),h.observe(r.value);else{var C;(C=h)==null||C.disconnect()}}),Fe(()=>{var i;(i=h)==null||i.disconnect()}),se(()=>{const i=!!(u.counter||e.counter||e.counterValue),C=!!(i||u.details),[_,w]=oe(d),[{modelValue:S,...$}]=re(e),[N]=he(e);return t(ue,z({ref:a,modelValue:f.value,"onUpdate:modelValue":R=>f.value=R,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow}]},_,$,{messages:x.value}),{...u,default:R=>{let{isDisabled:U,isDirty:O,isReadonly:W,isValid:X}=R;return t(xe,z({ref:n,style:{"--v-textarea-control-height":P.value},"onClick:control":G,"onClick:clear":K,role:"textbox"},N,{active:y.value||O.value,dirty:O.value||e.dirty,focused:g.value,error:X.value===!1}),{...u,default:F=>{let{props:{class:q,...ee}}=F;return t(A,null,[e.prefix&&t("span",{class:"v-text-field__prefix"},[e.prefix]),de(t("textarea",z({ref:k,class:q,value:f.value,onInput:Q,autofocus:e.autofocus,readonly:W.value,disabled:U.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:j,onBlur:()=>g.value=!1},ee,w),null),[[Be("intersect"),{handler:s},null,{once:!0}]]),e.autoGrow&&de(t("textarea",{class:[q,"v-textarea__sizer"],"onUpdate:modelValue":ye=>f.value=ye,ref:r,readonly:!0,"aria-hidden":"true"},null),[[Pe,f.value]]),e.suffix&&t("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:C?R=>{var U;return t(A,null,[(U=u.details)==null?void 0:U.call(u,R),i&&t(A,null,[t("span",null,null),t(Ve,{active:e.persistentCounter||g.value,value:v.value,max:I.value},u.counter)])])}:void 0})}),pe({},a,n,k)}}),Qe={id:"admin-products"},We=c("h1",{class:"text-center my-2"},"\u5546\u54C1\u7BA1\u7406",-1),Xe=L("mdi-plus"),et=c("thead",null,[c("tr",null,[c("th",{class:"text-center text-h6"},"\u7DE8\u865F"),c("th",{class:"text-center text-h6"},"\u5716\u7247"),c("th",{class:"text-center text-h6"},"\u540D\u7A31"),c("th",{class:"text-center text-h6"},"\u7A2E\u985E"),c("th",{class:"text-center text-h6"},"\u4E0A\u67B6"),c("th",{class:"text-center text-h6"},"\u7DE8\u8F2F"),c("th",{class:"text-center text-h6"},"\u522A\u9664")])],-1),tt={class:"text-center"},lt={class:"text-center"},at={class:"text-center"},nt={key:0,class:"text-center"},st={key:1,class:"text-center"},ot=L("mdi-pencil-outline"),it=L("mdi-delete"),rt={key:1},ut=c("td",{class:"text-center",colspan:"3"},"\u6C92\u6709\u5546\u54C1",-1),ct=[ut],dt={class:"text-h5"},ft=L("\u78BA\u5B9A"),mt=L("\u53D6\u6D88"),Ft={__name:"ProductsView",setup(e){const p=Y(["\u6D17\u9AEE\u7CFB\u5217","\u8B77\u9AEE\u7CFB\u5217","\u9020\u578B\u68B3","\u9020\u578B\u593E","\u96FB\u6372\u68D2","\u5439\u98A8\u6A5F"]),d=Y([]),l=Y({_id:"",name:"",price:0,sell:!1,category:"",image:"",description:"",idx:-1,dialog:!1,valid:!1,submitting:!1}),u=Y({required(s){return!!s||"\u5FC5\u586B"},price(s){return s>-1||"\u5FC5\u9808\u5927\u65BC\u7B49\u65BC 0"},size(s){var a,n,g;return!s||!s.length||((n=(a=s[0])==null?void 0:a.type)==null?void 0:n.includes("image"))&&((g=s[0])==null?void 0:g.size)<1024*1024||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26"}}),f=(s,a)=>{l._id=s,a>-1?(l.name=d[a].name,l.price=d[a].price,l.sell=d[a].sell,l.category=d[a].category,l.description=d[a].description):(l.name="",l.price=0,l.sell=!1,l.category="",l.description=""),l.image=[],l.idx=a,l.dialog=!0,l.valid=!1,l.submitting=!1},v=async()=>{if(!l.valid)return;l.submitting=!0;const s=new FormData;for(const a in l)["_id","idx","dialog","valid","submitting"].includes(a)||(a==="image"?s.append(a,l[a][0]):s.append(a,l[a]));try{if(l._id.length===0){const{data:a}=await te.post("/products",s);d.push(a.result),Z.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:a}=await te.patch("/products/"+l._id,s);console.log(s.name),d[l.idx]=a.result,Z.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}l.dialog=!1}catch(a){Z.fire({icon:"error",title:"\u5931\u6557",text:a.isAxiosError?a.response.data.message:a.message})}l.submitting=!1};return(async()=>{try{const{data:s}=await te.get("/products/all");d.push(...s.result)}catch(s){console.log(s),Z.fire({icon:"error",title:"\u5931\u6557",text:s.isAxiosError?s.response.data.message:s.message})}})(),(s,a)=>(D(),H("div",Qe,[t(T,{class:"justify-center"},{default:o(()=>[t(B,{cols:"9"},{default:o(()=>[We]),_:1}),t(B,{cols:"9"},{default:o(()=>[t(T,{class:"justify-end align-center",style:{height:"150px"}},{default:o(()=>[t(M,{icon:"",variant:"text",onClick:a[0]||(a[0]=n=>f("",-1))},{default:o(()=>[t(le,{color:"green lighten-2"},{default:o(()=>[Xe]),_:1})]),_:1})]),_:1})]),_:1}),t(B,{cols:"9"},{default:o(()=>[t(Ge,null,{default:o(()=>[et,c("tbody",null,[d.length>0?(D(!0),H(A,{key:0},Ie(d,(n,g)=>(D(),H("tr",{key:n._id},[c("td",tt,J(g+1),1),c("td",null,[t(Ne,{src:n.image},null,8,["src"])]),c("td",lt,J(n.name),1),c("td",at,J(n.category),1),n.sell===!0?(D(),H("td",nt,"\u5DF2\u4E0A\u67B6")):fe("",!0),n.sell===!1?(D(),H("td",st,"\u672A\u4E0A\u67B6")):fe("",!0),c("td",null,[t(T,{class:"justify-center"},{default:o(()=>[t(M,{onClick:P=>f(n._id,g),style:{width:"2rem",height:"2rem"},icon:"",variant:"text"},{default:o(()=>[t(le,{style:{"font-size":"large"},color:"blue lighten-2"},{default:o(()=>[ot]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),c("td",null,[t(T,{class:"justify-center align-center"},{default:o(()=>[t(M,{style:{width:"2rem",height:"2rem"},icon:"",variant:"text"},{default:o(()=>[t(le,{style:{"font-size":"large"},color:"red lighten-2"},{default:o(()=>[it]),_:1})]),_:1})]),_:1})])]))),128)):(D(),H("tr",rt,ct))])]),_:1})]),_:1})]),_:1}),t(Ue,{modelValue:l.dialog,"onUpdate:modelValue":a[9]||(a[9]=n=>l.dialog=n),persistent:""},{default:o(()=>[t(qe,{modelValue:l.valid,"onUpdate:modelValue":a[8]||(a[8]=n=>l.valid=n),onSubmit:Re(v,["prevent"])},{default:o(()=>[t(De,null,{default:o(()=>[t(He,{class:"text-center my-4"},{default:o(()=>[c("div",dt,J(l._id.length>0?"\u7DE8\u8F2F\u5546\u54C1":"\u65B0\u589E\u5546\u54C1"),1)]),_:1}),t(Te,null,{default:o(()=>[t(Ae,null,{default:o(()=>[t(T,{class:"justify-center"},{default:o(()=>[t(B,{cols:"9"},{default:o(()=>[t(me,{modelValue:l.name,"onUpdate:modelValue":a[1]||(a[1]=n=>l.name=n),label:"\u540D\u7A31",rules:[u.required]},null,8,["modelValue","rules"])]),_:1}),t(B,{cols:"9"},{default:o(()=>[t(me,{type:"number",min:"0",modelValue:l.price,"onUpdate:modelValue":a[2]||(a[2]=n=>l.price=n),label:"\u50F9\u683C",rules:[u.required,u.price]},null,8,["modelValue","rules"])]),_:1}),t(B,{cols:"9"},{default:o(()=>[t(Ye,{modelValue:l.sell,"onUpdate:modelValue":a[3]||(a[3]=n=>l.sell=n),label:"\u4E0A\u67B6"},null,8,["modelValue"])]),_:1}),t(B,{cols:"9"},{default:o(()=>[t(Oe,{items:p,modelValue:l.category,"onUpdate:modelValue":a[4]||(a[4]=n=>l.category=n),label:"\u5206\u985E",rules:[u.required]},null,8,["items","modelValue","rules"])]),_:1}),t(B,{cols:"9"},{default:o(()=>[t(Ze,{modelValue:l.image,"onUpdate:modelValue":a[5]||(a[5]=n=>l.image=n),"show-size":"",accept:"image/*",label:"\u5546\u54C1\u5716\u7247","prepend-icon":"",outlined:"",rules:[u.size]},null,8,["modelValue","rules"])]),_:1}),t(B,{cols:"9"},{default:o(()=>[t(Je,{modelValue:l.description,"onUpdate:modelValue":a[6]||(a[6]=n=>l.description=n),label:"\u5546\u54C1\u4ECB\u7D39"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(je,null,{default:o(()=>[t(T,{class:"justify-center"},{default:o(()=>[t(M,{type:"submit",color:"primary",loading:l.submitting},{default:o(()=>[ft]),_:1},8,["loading"]),t(M,{color:"error",onClick:a[7]||(a[7]=n=>l.dialog=!1),disabled:l.submitting},{default:o(()=>[mt]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1},8,["modelValue"])]))}};export{Ft as default};
