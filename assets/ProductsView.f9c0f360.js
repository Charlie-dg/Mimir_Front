import{D as W,C as be,z as y,J as X,ar as oe,a as t,ad as z,I as ke,as as Ce,av as we,y as ve,r as b,F as A,bf as ce,aF as ne,T as Se,E as Fe,Z as Pe,a2 as Be,a5 as $e,ah as ge,aL as ze,bg as Ie,a1 as q,A as Re,M as de,a9 as Ae,bh as Te,aZ as De,n as O,o as N,c as U,w as n,V as H,bi as ae,S as K,d as P,k as G,m as se,b as f,q as Ne,b7 as Ue,h as He,t as Q,be as je,j as L,f as Ee,g as fe}from"./index.a84ae795.js";import{b as Me,a as qe,c as Ge,V as Le}from"./VDialog.99e7bbe4.js";import{V as Ze}from"./VForm.f53bbfee.js";import{e as ie,h as re,i as ue,j as he,k as xe,l as Ve,o as ye,f as pe,b as me}from"./VTextField.377b1b93.js";import{m as Je,f as Oe,d as Ke,b as Qe,a as We}from"./VSelect.48c7dbe9.js";import"./VOverlay.a93f5dfd.js";import"./VList.4dc1f4f5.js";import"./VDivider.1944627a.js";const Xe=W({name:"VCheckbox",inheritAttrs:!1,props:{...ie(),...Je()},setup(e,x){let{attrs:r,slots:l}=x;const u=be(),d=y(()=>e.id||`checkbox-${u}`);return X(()=>{const[m,I]=oe(r),[o,a]=re(e),[s,g]=Oe(e);return t(ue,z({class:"v-checkbox"},m,o,{id:d.value}),{...l,default:B=>{let{id:k,isDisabled:p,isReadonly:V}=B;return t(Ke,z(s,{id:k.value,disabled:p.value,readonly:V.value},I),l)}})}),{}}});const Ye=W({name:"VFileInput",inheritAttrs:!1,props:{chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,hint:String,persistentHint:Boolean,placeholder:String,showSize:{type:[Boolean,Number],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(e)},...ie(),prependIcon:{type:ke,default:"$file"},modelValue:{type:Array,default:()=>[],validator:e=>Ce(e).every(x=>x!=null&&typeof x=="object")},...he({clearable:!0})},emits:{"click:clear":e=>!0,"click:control":e=>!0,"update:modelValue":e=>!0},setup(e,x){let{attrs:r,emit:l,slots:u}=x;const{t:d}=we(),m=ve(e,"modelValue"),I=y(()=>typeof e.showSize!="boolean"?e.showSize:void 0),o=y(()=>{var c;return((c=m.value)!=null?c:[]).reduce((v,h)=>{let{size:i=0}=h;return v+i},0)}),a=y(()=>ce(o.value,I.value)),s=y(()=>{var c;return((c=m.value)!=null?c:[]).map(v=>{const{name:h="",size:i=0}=v;return e.showSize?`${h} (${ce(i,I.value)})`:h})}),g=y(()=>{var c,v;const h=(c=(v=m.value)==null?void 0:v.length)!=null?c:0;return e.showSize?d(e.counterSizeString,h,a.value):d(e.counterString,h)}),B=b(),k=b(),p=b(!1),V=b(),j=y(()=>e.messages.length?e.messages:e.persistentHint?e.hint:"");function E(){if(V.value!==document.activeElement){var c;(c=V.value)==null||c.focus()}p.value||(p.value=!0)}function Z(c){var v;(v=V.value)==null||v.click(),l("click:control",c)}function Y(c){c.stopPropagation(),E(),ne(()=>{m.value=[],V!=null&&V.value&&(V.value.value=""),l("click:clear",c)})}return X(()=>{const c=!!(u.counter||e.counter),v=!!(c||u.details),[h,i]=oe(r),[{modelValue:C,..._}]=re(e),[w]=xe(e);return t(ue,z({ref:B,modelValue:m.value,"onUpdate:modelValue":S=>m.value=S,class:"v-file-input"},h,_,{"onClick:prepend":Z,messages:j.value}),{...u,default:S=>{let{isDisabled:$,isDirty:T,isReadonly:R,isValid:D}=S;return t(Ve,z({ref:k,"prepend-icon":e.prependIcon,"onClick:control":Z,"onClick:clear":Y},w,{active:T.value||p.value,dirty:T.value,focused:p.value,error:D.value===!1}),{...u,default:J=>{let{props:{class:ee,...te}}=J;return t(A,null,[t("input",z({ref:V,type:"file",readonly:R.value,disabled:$.value,multiple:e.multiple,name:e.name,onClick:F=>{F.stopPropagation(),E()},onChange:F=>{var M;if(!F.target)return;const le=F.target;m.value=[...(M=le.files)!=null?M:[]]},onFocus:E,onBlur:()=>p.value=!1},te,i),null),m.value.length>0&&t("div",{class:ee},[u.selection?u.selection({fileNames:s.value,totalBytes:o.value,totalBytesReadable:a.value}):e.chips?s.value.map(F=>t(Qe,{key:F,size:"small",color:e.color},{default:()=>[F]})):s.value.join(", ")])])}})},details:v?S=>{var $;return t(A,null,[($=u.details)==null?void 0:$.call(u,S),c&&t(A,null,[t("span",null,null),t(ye,{active:!!m.value.length,value:g.value},u.counter)])])}:void 0})}),pe({},B,k,V)}});const et=W({name:"VTable",props:{fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],...Se(),...Fe(),...Pe()},setup(e,x){let{slots:r}=x;const{themeClasses:l}=Be(e),{densityClasses:u}=$e(e);return X(()=>{var d,m;return t(e.tag,{class:["v-table",{"v-table--fixed-height":!!e.height,"v-table--fixed-header":e.fixedHeader,"v-table--fixed-footer":e.fixedFooter,"v-table--has-top":!!r.top,"v-table--has-bottom":!!r.bottom},l.value,u.value]},{default:()=>[(d=r.top)==null?void 0:d.call(r),r.default&&t("div",{class:"v-table__wrapper",style:{height:ge(e.height)}},[t("table",null,[r.default()])]),(m=r.bottom)==null?void 0:m.call(r)]})}),{}}});const tt=W({name:"VTextarea",directives:{Intersect:ze},inheritAttrs:!1,props:{autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,hint:String,persistentHint:Boolean,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,...ie(),...he()},emits:{"click:clear":e=>!0,"click:control":e=>!0,"update:modelValue":e=>!0},setup(e,x){let{attrs:r,emit:l,slots:u}=x;const d=ve(e,"modelValue"),m=y(()=>typeof e.counterValue=="function"?e.counterValue(d.value):(d.value||"").toString().length),I=y(()=>{if(r.maxlength)return r.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function o(i,C){var _,w;!e.autofocus||!i||(_=C[0].target)==null||(w=_.focus)==null||w.call(_)}const a=b(),s=b(),g=b(!1),B=b(""),k=b(),p=y(()=>g.value||e.persistentPlaceholder),V=y(()=>e.messages.length?e.messages:p.value||e.persistentHint?e.hint:"");function j(){if(k.value!==document.activeElement){var i;(i=k.value)==null||i.focus()}g.value||(g.value=!0)}function E(i){j(),l("click:control",i)}function Z(i){i.stopPropagation(),j(),ne(()=>{d.value="",l("click:clear",i)})}function Y(i){d.value=i.target.value}const c=b();function v(){!e.autoGrow||ne(()=>{if(!c.value||!s.value)return;const i=getComputedStyle(c.value),C=getComputedStyle(s.value.$el),_=parseFloat(i.getPropertyValue("--v-field-padding-top"))+parseFloat(i.getPropertyValue("--v-input-padding-top"))+parseFloat(i.getPropertyValue("--v-field-padding-bottom")),w=c.value.scrollHeight,S=parseFloat(i.lineHeight),$=Math.max(parseFloat(e.rows)*S+_,parseFloat(C.getPropertyValue("--v-input-control-height"))),T=parseFloat(e.maxRows)*S+_||1/0;B.value=ge(De(w!=null?w:0,$,T))})}Ie(v),q(d,v),q(()=>e.rows,v),q(()=>e.maxRows,v),q(()=>e.density,v);let h;return q(c,i=>{if(i)h=new ResizeObserver(v),h.observe(c.value);else{var C;(C=h)==null||C.disconnect()}}),Re(()=>{var i;(i=h)==null||i.disconnect()}),X(()=>{const i=!!(u.counter||e.counter||e.counterValue),C=!!(i||u.details),[_,w]=oe(r),[{modelValue:S,...$}]=re(e),[T]=xe(e);return t(ue,z({ref:a,modelValue:d.value,"onUpdate:modelValue":R=>d.value=R,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow}]},_,$,{messages:V.value}),{...u,default:R=>{let{isDisabled:D,isDirty:J,isReadonly:ee,isValid:te}=R;return t(Ve,z({ref:s,style:{"--v-textarea-control-height":B.value},"onClick:control":E,"onClick:clear":Z,role:"textbox"},T,{active:p.value||J.value,dirty:J.value||e.dirty,focused:g.value,error:te.value===!1}),{...u,default:F=>{let{props:{class:M,...le}}=F;return t(A,null,[e.prefix&&t("span",{class:"v-text-field__prefix"},[e.prefix]),de(t("textarea",z({ref:k,class:M,value:d.value,onInput:Y,autofocus:e.autofocus,readonly:ee.value,disabled:D.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:j,onBlur:()=>g.value=!1},le,w),null),[[Ae("intersect"),{handler:o},null,{once:!0}]]),e.autoGrow&&de(t("textarea",{class:[M,"v-textarea__sizer"],"onUpdate:modelValue":_e=>d.value=_e,ref:c,readonly:!0,"aria-hidden":"true"},null),[[Te,d.value]]),e.suffix&&t("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:C?R=>{var D;return t(A,null,[(D=u.details)==null?void 0:D.call(u,R),i&&t(A,null,[t("span",null,null),t(ye,{active:e.persistentCounter||g.value,value:m.value,max:I.value},u.counter)])])}:void 0})}),pe({},a,s,k)}}),lt={id:"admin-product"},at=f("h1",{class:"text-center my-2"},"\u5546\u54C1\u7BA1\u7406",-1),st=L("mdi-plus"),nt=f("thead",null,[f("tr",null,[f("th",{class:"text-center text-h6"},"\u7DE8\u865F"),f("th",{class:"text-center text-h6"},"\u5716\u7247"),f("th",{class:"text-center text-h6"},"\u540D\u7A31"),f("th",{class:"text-center text-h6"},"\u7A2E\u985E"),f("th",{class:"text-center text-h6"},"\u4E0A\u67B6"),f("th",{class:"text-center text-h6"},"\u7DE8\u8F2F"),f("th",{class:"text-center text-h6"},"\u522A\u9664")])],-1),ot={class:"text-center"},it={class:"text-center"},rt={class:"text-center"},ut={key:0,class:"text-center"},ct={key:1,class:"text-center"},dt=L("mdi-edit"),ft=L("mdi-delete"),mt={key:1},vt=f("td",{class:"text-center",colspan:"3"},"\u6C92\u6709\u5546\u54C1",-1),gt=[vt],ht={class:"text-h5"},xt=L("\u78BA\u5B9A"),Vt=L("\u53D6\u6D88"),Ft={__name:"ProductsView",setup(e){const x=O(["\u6D17\u9AEE\u7CFB\u5217","\u8B77\u9AEE\u7CFB\u5217","\u9020\u578B\u68B3","\u9020\u578B\u593E","\u96FB\u6372\u68D2","\u5439\u98A8\u6A5F"]),r=O([]),l=O({_id:"",name:"",price:0,sell:!1,category:"",image:"",description:"",idx:-1,dialog:!1,valid:!1,submitting:!1}),u=O({required(o){return!!o||"\u5FC5\u586B"},price(o){return o>-1||"\u5FC5\u9808\u5927\u65BC\u7B49\u65BC 0"},size(o){var a,s,g;return!o||!o.length||((s=(a=o[0])==null?void 0:a.type)==null?void 0:s.includes("image"))&&((g=o[0])==null?void 0:g.size)<1024*1024||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26"}}),d=(o,a)=>{console.log(r[a]),l._id=o,a>-1?(l.name=r[a].name,l.price=r[a].price,l.sell=r[a].sell,l.category=r[a].category,l.description=r[a].description):(l.name="",l.price=0,l.sell=!1,l.category="",l.description=""),l.image=[],l.idx=a,l.dialog=!0,l.valid=!1,l.submitting=!1},m=async()=>{if(!l.valid)return;l.submitting=!0;const o=new FormData;for(const a in l)["_id","idx","dialog","valid","submitting"].includes(a)||(a==="image"?o.append(a,l[a][0]):o.append(a,l[a]));try{if(l._id.length===0){const{data:a}=await ae.post("/products",o);r.push(a.result),K.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:a}=await ae.patch("/products/"+l._id,o);r[l.idx]=a.result,K.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}l.dialog=!1}catch(a){K.fire({icon:"error",title:"\u5931\u6557",text:a.isAxiosError?a.response.data.message:a.message})}l.submitting=!1};return(async()=>{try{const{data:o}=await ae.get("/products/all");r.push(...o.result)}catch(o){console.log(o),K.fire({icon:"error",title:"\u5931\u6557",text:o.isAxiosError?o.response.data.message:o.message})}})(),(o,a)=>(N(),U("div",lt,[t(H,{class:"justify-center"},{default:n(()=>[t(P,{cols:"9"},{default:n(()=>[at]),_:1}),t(P,{cols:"9"},{default:n(()=>[t(H,{class:"justify-end align-center",style:{height:"150px"}},{default:n(()=>[t(G,{icon:"",variant:"text",onClick:a[0]||(a[0]=s=>d("",-1))},{default:n(()=>[t(se,{color:"green lighten-2"},{default:n(()=>[st]),_:1})]),_:1})]),_:1})]),_:1}),t(P,{cols:"9"},{default:n(()=>[t(et,null,{default:n(()=>[nt,f("tbody",null,[r.length>0?(N(!0),U(A,{key:0},Ne(r,(s,g)=>(N(),U("tr",{key:s._id},[f("td",ot,Q(g+1),1),f("td",null,[t(Ee,{src:s.image},null,8,["src"])]),f("td",it,Q(s.name),1),f("td",rt,Q(s.category),1),s.sell===!0?(N(),U("td",ut,"\u5DF2\u4E0A\u67B6")):fe("",!0),s.sell===!1?(N(),U("td",ct,"\u672A\u4E0A\u67B6")):fe("",!0),f("td",null,[t(H,{class:"justify-center"},{default:n(()=>[t(G,{onClick:B=>d(s._id,g),style:{width:"2rem",height:"2rem"},icon:""},{default:n(()=>[t(se,{style:{"font-size":"large"},color:"blue lighten-2"},{default:n(()=>[dt]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),f("td",null,[t(H,{class:"justify-center align-center"},{default:n(()=>[t(G,{style:{width:"2rem",height:"2rem"},icon:""},{default:n(()=>[t(se,{style:{"font-size":"large"},color:"red lighten-2"},{default:n(()=>[ft]),_:1})]),_:1})]),_:1})])]))),128)):(N(),U("tr",mt,gt))])]),_:1})]),_:1})]),_:1}),t(Me,{modelValue:l.dialog,"onUpdate:modelValue":a[9]||(a[9]=s=>l.dialog=s),persistent:""},{default:n(()=>[t(Ze,{modelValue:l.valid,"onUpdate:modelValue":a[8]||(a[8]=s=>l.valid=s),onSubmit:Ue(m,["prevent"])},{default:n(()=>[t(qe,null,{default:n(()=>[t(He,{class:"text-center my-4"},{default:n(()=>[f("div",ht,Q(l._id.length>0?"\u7DE8\u8F2F\u5546\u54C1":"\u65B0\u589E\u5546\u54C1"),1)]),_:1}),t(Ge,null,{default:n(()=>[t(je,null,{default:n(()=>[t(H,{class:"justify-center"},{default:n(()=>[t(P,{cols:"9"},{default:n(()=>[t(me,{modelValue:l.name,"onUpdate:modelValue":a[1]||(a[1]=s=>l.name=s),label:"\u540D\u7A31",rules:[u.required]},null,8,["modelValue","rules"])]),_:1}),t(P,{cols:"9"},{default:n(()=>[t(me,{type:"number",min:"0",modelValue:l.price,"onUpdate:modelValue":a[2]||(a[2]=s=>l.price=s),label:"\u50F9\u683C",rules:[u.required,u.price]},null,8,["modelValue","rules"])]),_:1}),t(P,{cols:"9"},{default:n(()=>[t(Xe,{modelValue:l.sell,"onUpdate:modelValue":a[3]||(a[3]=s=>l.sell=s),label:"\u4E0A\u67B6"},null,8,["modelValue"])]),_:1}),t(P,{cols:"9"},{default:n(()=>[t(We,{items:x,modelValue:l.category,"onUpdate:modelValue":a[4]||(a[4]=s=>l.category=s),label:"\u5206\u985E",rules:[u.required]},null,8,["items","modelValue","rules"])]),_:1}),t(P,{cols:"9"},{default:n(()=>[t(Ye,{modelValue:l.image,"onUpdate:modelValue":a[5]||(a[5]=s=>l.image=s),"show-size":"",accept:"image/*",label:"\u5546\u54C1\u5716\u7247","prepend-icon":"",outlined:"",rules:[u.size]},null,8,["modelValue","rules"])]),_:1}),t(P,{cols:"9"},{default:n(()=>[t(tt,{modelValue:l.description,"onUpdate:modelValue":a[6]||(a[6]=s=>l.description=s),label:"\u5546\u54C1\u4ECB\u7D39"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(Le,null,{default:n(()=>[t(H,{class:"justify-center"},{default:n(()=>[t(G,{type:"submit",color:"primary",loading:l.submitting},{default:n(()=>[xt]),_:1},8,["loading"]),t(G,{color:"error",onClick:a[7]||(a[7]=s=>l.dialog=!1),disabled:l.submitting},{default:n(()=>[Vt]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1},8,["modelValue"])]))}};export{Ft as default};
