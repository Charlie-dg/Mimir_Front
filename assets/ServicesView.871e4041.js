import{l as h,o as c,c as u,a as s,w as a,V as m,bg as V,S as f,d as n,i as p,k as y,b as i,F as U,n as j,b8 as F,t as _,bf as q,h as g,g as v}from"./index.89256b45.js";import{d as A,c as B,V as D,e as E,b as N}from"./VDialog.8dfed00a.js";import{V as $}from"./VTable.9fd3b2fe.js";import{V as z}from"./VForm.eb7aa19f.js";import{a as b}from"./VTextField.f16bee7e.js";import{V as I}from"./VSelect.3a943fbe.js";import{V as L}from"./VCheckbox.38dd82cd.js";import"./createSimpleFunctional.baa32468.js";import"./VAvatar.118222b3.js";import"./scopeId.a0be6a54.js";import"./form.dd879711.js";import"./VOverlay.89393687.js";import"./VList.8d4d91d0.js";import"./VDivider.f6808403.js";import"./VChip.70ad6a18.js";const M={id:"admin-services"},P=i("h1",{class:"text-center my-2"},"\u670D\u52D9\u7BA1\u7406",-1),R=g("mdi-plus"),G=i("thead",null,[i("tr",null,[i("th",{class:"text-center text-h6"},"\u7DE8\u865F"),i("th",{class:"text-center text-h6"},"\u670D\u52D9\u540D\u7A31"),i("th",{class:"text-center text-h6"},"\u670D\u52D9\u9805\u76EE"),i("th",{class:"text-center text-h6"},"\u50F9\u683C"),i("th",{class:"text-center text-h6"},"\u9810\u8A08\u6642\u9593(hr)"),i("th",{class:"text-center text-h6"},"\u4E0A\u67B6"),i("th",{class:"text-center text-h6"},"\u7DE8\u8F2F"),i("th",{class:"text-center text-h6"},"\u522A\u9664")])],-1),H={class:"text-center"},J={class:"text-center"},K={class:"text-center"},O={class:"text-center"},Q={class:"text-center"},W={key:0,class:"text-center"},X={key:1,class:"text-center"},Y=g("mdi-pencil-outline"),Z=g("mdi-delete"),ee={key:1},te=i("td",{class:"text-center text-h6",colspan:"8"},"\u5C1A\u7121\u670D\u52D9",-1),se=[te],le={class:"text-h5"},ae=g("\u78BA\u5B9A"),oe=g("\u53D6\u6D88"),ve={__name:"ServicesView",setup(ie){const C=h(["\u6D17\u9AEE","\u526A\u9AEE","\u67D3\u9AEE","\u71D9\u9AEE","\u8B77\u9AEE"]),r=h([]),e=h({_id:"",name:"",category:"",price:0,costTime:0,sell:!1,idx:-1,dialog:!1,valid:!1,submitting:!1}),d=h({required(o){return!!o||"\u5FC5\u586B"},price(o){return o>-1||"\u5FC5\u9808\u5927\u65BC\u7B49\u65BC 0"},costTime(o){return o>-1||"\u5FC5\u9808\u5927\u65BC\u7B49\u65BC 0"}}),k=(o,t)=>{e._id=o,t>-1?(e.name=r[t].name,e.category=r[t].category,e.price=r[t].price,e.costTime=r[t].costTime,e.sell=r[t].sell):(e.name="",e.category="",e.price=0,e.costTime=0,e.sell=!1),e.idx=t,e.dialog=!0,e.valid=!1,e.submitting=!1},T=async()=>{if(!e.valid)return;e.submitting=!0;const o=new FormData;for(const t in e)["_id","idx","dialog","valid","submitting"].includes(t)||(t==="image"?o.append(t,e[t][0]):o.append(t,e[t]));try{if(e._id.length===0){const{data:t}=await V.post("/services",o);r.push(t.result),f.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:t}=await V.patch("/services/"+e._id,o);console.log(o.name),r[e.idx]=t.result,f.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(t){f.fire({icon:"error",title:"\u5931\u6557",text:t.isAxiosError?t.response.data.message:t.message})}e.submitting=!1},w=async(o,t)=>{try{if(o.length!==0){const{data:l}=await V.delete("/services/"+o);r.splice(t,1),f.fire({icon:"success",title:"\u6210\u529F",text:"\u522A\u9664\u6210\u529F"})}}catch(l){f.fire({icon:"error",title:"\u5931\u6557",text:l.isAxiosError?l.response.data.message:l.message})}};return(async()=>{try{const{data:o}=await V.get("/services/all");r.push(...o.result)}catch(o){console.log(o),f.fire({icon:"error",title:"\u5931\u6557",text:o.isAxiosError?o.response.data.message:o.message})}})(),(o,t)=>(c(),u("div",M,[s(m,{class:"justify-center"},{default:a(()=>[s(n,{cols:"9"},{default:a(()=>[P]),_:1}),s(n,{cols:"9"},{default:a(()=>[s(m,{class:"justify-end align-center",style:{height:"150px"}},{default:a(()=>[s(p,{icon:"",variant:"text",onClick:t[0]||(t[0]=l=>k("",-1))},{default:a(()=>[s(y,{color:"green lighten-2"},{default:a(()=>[R]),_:1})]),_:1})]),_:1})]),_:1}),s(n,{cols:"9"},{default:a(()=>[s($,null,{default:a(()=>[G,i("tbody",null,[r.length>0?(c(!0),u(U,{key:0},j(r,(l,x)=>(c(),u("tr",{key:l._id},[i("td",H,_(x+1),1),i("td",J,_(l.name),1),i("td",K,_(l.category),1),i("td",O,_(l.price),1),i("td",Q,_(l.costTime),1),l.sell===!0?(c(),u("td",W,"\u5DF2\u4E0A\u67B6")):v("",!0),l.sell===!1?(c(),u("td",X,"\u672A\u4E0A\u67B6")):v("",!0),i("td",null,[s(m,{class:"justify-center"},{default:a(()=>[s(p,{onClick:S=>k(l._id,x),style:{width:"2rem",height:"2rem"},icon:"",variant:"text"},{default:a(()=>[s(y,{style:{"font-size":"large"},color:"blue lighten-2"},{default:a(()=>[Y]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),i("td",null,[s(m,{class:"justify-center align-center"},{default:a(()=>[s(p,{onClick:S=>w(l._id,x),style:{width:"2rem",height:"2rem"},icon:"",variant:"text"},{default:a(()=>[s(y,{style:{"font-size":"large"},color:"red lighten-2"},{default:a(()=>[Z]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]))),128)):(c(),u("tr",ee,se))])]),_:1})]),_:1})]),_:1}),s(A,{modelValue:e.dialog,"onUpdate:modelValue":t[8]||(t[8]=l=>e.dialog=l),persistent:""},{default:a(()=>[s(z,{modelValue:e.valid,"onUpdate:modelValue":t[7]||(t[7]=l=>e.valid=l),onSubmit:F(T,["prevent"])},{default:a(()=>[s(B,null,{default:a(()=>[s(D,{class:"text-center my-4"},{default:a(()=>[i("div",le,_(e._id.length>0?"\u7DE8\u8F2F\u670D\u52D9":"\u65B0\u589E\u670D\u52D9"),1)]),_:1}),s(E,null,{default:a(()=>[s(q,null,{default:a(()=>[s(m,{class:"justify-center"},{default:a(()=>[s(n,{cols:"9"},{default:a(()=>[s(b,{modelValue:e.name,"onUpdate:modelValue":t[1]||(t[1]=l=>e.name=l),label:"\u670D\u52D9\u540D\u7A31",rules:[d.required]},null,8,["modelValue","rules"])]),_:1}),s(n,{cols:"9"},{default:a(()=>[s(I,{items:C,modelValue:e.category,"onUpdate:modelValue":t[2]||(t[2]=l=>e.category=l),label:"\u670D\u52D9\u9805\u76EE",rules:[d.required]},null,8,["items","modelValue","rules"])]),_:1}),s(n,{cols:"9"},{default:a(()=>[s(b,{type:"number",min:"0",modelValue:e.price,"onUpdate:modelValue":t[3]||(t[3]=l=>e.price=l),label:"\u50F9\u683C",rules:[d.required,d.price]},null,8,["modelValue","rules"])]),_:1}),s(n,{cols:"9"},{default:a(()=>[s(b,{type:"number",min:"0",modelValue:e.costTime,"onUpdate:modelValue":t[4]||(t[4]=l=>e.costTime=l),label:"\u9810\u8A08\u6642\u9593",rules:[d.required,d.costTime]},null,8,["modelValue","rules"])]),_:1}),s(n,{cols:"9"},{default:a(()=>[s(L,{modelValue:e.sell,"onUpdate:modelValue":t[5]||(t[5]=l=>e.sell=l),label:"\u4E0A\u67B6"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),s(N,null,{default:a(()=>[s(m,{class:"justify-center"},{default:a(()=>[s(p,{type:"submit",color:"primary",loading:e.submitting},{default:a(()=>[ae]),_:1},8,["loading"]),s(p,{color:"error",onClick:t[6]||(t[6]=l=>e.dialog=!1),disabled:e.submitting},{default:a(()=>[oe]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1},8,["modelValue"])]))}};export{ve as default};
