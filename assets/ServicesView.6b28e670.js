import{r as h,o as c,c as u,a as l,w as s,V as m,be as V,S as f,d as n,K as _,Y as x,g as i,F as j,e as S,bc as q,h as F,k as A,t as p,q as $,l as B,W as D,U as g,bk as v}from"./index.e4f4be16.js";import{V as E}from"./VDialog.aa25684a.js";import{V as N}from"./VTable.7e41e67e.js";import{V as z}from"./VForm.ffec5a6d.js";import{V as b}from"./VTextField.0cadf745.js";import{V as I}from"./VSelect.aecf85ee.js";import{V as K}from"./VCheckbox.3ce4faf8.js";import"./scopeId.e76ccd41.js";import"./easing.1a8f6470.js";import"./form.0bbaacac.js";import"./VOverlay.f03e4f25.js";import"./VList.fe61b665.js";import"./VChip.39d4fdb1.js";const L={id:"admin-services"},M=i("h1",{class:"text-center my-2"},"\u670D\u52D9\u7BA1\u7406",-1),P=g("mdi-plus"),R=i("thead",null,[i("tr",null,[i("th",{class:"text-center text-h6"},"\u7DE8\u865F"),i("th",{class:"text-center text-h6"},"\u670D\u52D9\u540D\u7A31"),i("th",{class:"text-center text-h6"},"\u670D\u52D9\u9805\u76EE"),i("th",{class:"text-center text-h6"},"\u50F9\u683C"),i("th",{class:"text-center text-h6"},"\u9810\u8A08\u6642\u9593(hr)"),i("th",{class:"text-center text-h6"},"\u4E0A\u67B6"),i("th",{class:"text-center text-h6"},"\u7DE8\u8F2F"),i("th",{class:"text-center text-h6"},"\u522A\u9664")])],-1),W={class:"text-center"},Y={class:"text-center"},G={class:"text-center"},H={class:"text-center"},J={class:"text-center"},O={key:0,class:"text-center"},Q={key:1,class:"text-center"},X=g("mdi-pencil-outline"),Z=g("mdi-delete"),ee={key:1},te=i("td",{class:"text-center text-h6",colspan:"8"},"\u5C1A\u7121\u670D\u52D9",-1),le=[te],se=g("mdi-close"),ae={class:"text-h5"},oe=g("\u78BA\u5B9A"),ie=g("\u53D6\u6D88"),ke={__name:"ServicesView",setup(re){const C=h(["\u6D17\u9AEE","\u526A\u9AEE","\u67D3\u9AEE","\u71D9\u9AEE","\u8B77\u9AEE"]),r=h([]),t=h({_id:"",name:"",category:"",price:0,costTime:0,sell:!1,idx:-1,dialog:!1,valid:!1,submitting:!1}),d=h({required(o){return!!o||"\u5FC5\u586B"},price(o){return o>-1||"\u5FC5\u9808\u5927\u65BC\u7B49\u65BC 0"},costTime(o){return o>-1||"\u5FC5\u9808\u5927\u65BC\u7B49\u65BC 0"}}),k=(o,e)=>{t._id=o,e>-1?(t.name=r[e].name,t.category=r[e].category,t.price=r[e].price,t.costTime=r[e].costTime,t.sell=r[e].sell):(t.name="",t.category="",t.price=0,t.costTime=0,t.sell=!1),t.idx=e,t.dialog=!0,t.valid=!1,t.submitting=!1},T=async()=>{if(!t.valid)return;t.submitting=!0;const o=new FormData;for(const e in t)["_id","idx","dialog","valid","submitting"].includes(e)||(e==="image"?o.append(e,t[e][0]):o.append(e,t[e]));try{if(t._id.length===0){const{data:e}=await V.post("/services",o);r.push(e.result),f.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:e}=await V.patch("/services/"+t._id,o);console.log(o.name),r[t.idx]=e.result,f.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}t.dialog=!1}catch(e){f.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}t.submitting=!1},w=async(o,e)=>{try{if(o.length!==0){const{data:a}=await V.delete("/services/"+o);r.splice(e,1),f.fire({icon:"success",title:"\u6210\u529F",text:"\u522A\u9664\u6210\u529F"})}}catch(a){f.fire({icon:"error",title:"\u5931\u6557",text:a.isAxiosError?a.response.data.message:a.message})}};return(async()=>{try{const{data:o}=await V.get("/services/all");r.push(...o.result)}catch(o){console.log(o),f.fire({icon:"error",title:"\u5931\u6557",text:o.isAxiosError?o.response.data.message:o.message})}})(),(o,e)=>(c(),u("div",L,[l(m,{class:"justify-center"},{default:s(()=>[l(n,{cols:"9"},{default:s(()=>[M]),_:1}),l(n,{cols:"9"},{default:s(()=>[l(m,{class:"justify-end align-center",style:{height:"150px"}},{default:s(()=>[l(_,{icon:"",variant:"text",onClick:e[0]||(e[0]=a=>k("",-1))},{default:s(()=>[l(x,{color:"green lighten-2"},{default:s(()=>[P]),_:1})]),_:1})]),_:1})]),_:1}),l(n,{cols:"9"},{default:s(()=>[l(N,null,{default:s(()=>[R,i("tbody",null,[r.length>0?(c(!0),u(j,{key:0},S(r,(a,y)=>(c(),u("tr",{key:a._id},[i("td",W,p(y+1),1),i("td",Y,p(a.name),1),i("td",G,p(a.category),1),i("td",H,p(a.price),1),i("td",J,p(a.costTime),1),a.sell===!0?(c(),u("td",O,"\u5DF2\u4E0A\u67B6")):v("",!0),a.sell===!1?(c(),u("td",Q,"\u672A\u4E0A\u67B6")):v("",!0),i("td",null,[l(m,{class:"justify-center"},{default:s(()=>[l(_,{onClick:U=>k(a._id,y),style:{width:"2rem",height:"2rem"},icon:"",variant:"text"},{default:s(()=>[l(x,{style:{"font-size":"large"},color:"blue lighten-2"},{default:s(()=>[X]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),i("td",null,[l(m,{class:"justify-center align-center"},{default:s(()=>[l(_,{onClick:U=>w(a._id,y),style:{width:"2rem",height:"2rem"},icon:"",variant:"text"},{default:s(()=>[l(x,{style:{"font-size":"large"},color:"red lighten-2"},{default:s(()=>[Z]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]))),128)):(c(),u("tr",ee,le))])]),_:1})]),_:1})]),_:1}),l(E,{modelValue:t.dialog,"onUpdate:modelValue":e[9]||(e[9]=a=>t.dialog=a),persistent:""},{default:s(()=>[l(z,{modelValue:t.valid,"onUpdate:modelValue":e[8]||(e[8]=a=>t.valid=a),onSubmit:q(T,["prevent"])},{default:s(()=>[l(F,null,{default:s(()=>[l(n,{class:"d-flex justify-end"},{default:s(()=>[l(_,{icon:"",variant:"text",size:"x-small",onClick:e[1]||(e[1]=a=>t.dialog=!1)},{default:s(()=>[l(x,null,{default:s(()=>[se]),_:1})]),_:1})]),_:1}),l(A,{class:"text-center my-4"},{default:s(()=>[i("div",ae,p(t._id.length>0?"\u7DE8\u8F2F\u670D\u52D9":"\u65B0\u589E\u670D\u52D9"),1)]),_:1}),l($,null,{default:s(()=>[l(B,null,{default:s(()=>[l(m,{class:"justify-center"},{default:s(()=>[l(n,{cols:"9"},{default:s(()=>[l(b,{modelValue:t.name,"onUpdate:modelValue":e[2]||(e[2]=a=>t.name=a),label:"\u670D\u52D9\u540D\u7A31",rules:[d.required]},null,8,["modelValue","rules"])]),_:1}),l(n,{cols:"9"},{default:s(()=>[l(I,{items:C,modelValue:t.category,"onUpdate:modelValue":e[3]||(e[3]=a=>t.category=a),label:"\u670D\u52D9\u9805\u76EE",rules:[d.required]},null,8,["items","modelValue","rules"])]),_:1}),l(n,{cols:"9"},{default:s(()=>[l(b,{type:"number",min:"0",modelValue:t.price,"onUpdate:modelValue":e[4]||(e[4]=a=>t.price=a),label:"\u50F9\u683C",rules:[d.required,d.price]},null,8,["modelValue","rules"])]),_:1}),l(n,{cols:"9"},{default:s(()=>[l(b,{type:"number",min:"0",modelValue:t.costTime,"onUpdate:modelValue":e[5]||(e[5]=a=>t.costTime=a),label:"\u9810\u8A08\u6642\u9593",rules:[d.required,d.costTime]},null,8,["modelValue","rules"])]),_:1}),l(n,{cols:"9"},{default:s(()=>[l(K,{modelValue:t.sell,"onUpdate:modelValue":e[6]||(e[6]=a=>t.sell=a),label:"\u4E0A\u67B6"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(D,null,{default:s(()=>[l(m,{class:"justify-center"},{default:s(()=>[l(_,{type:"submit",color:"primary",loading:t.submitting},{default:s(()=>[oe]),_:1},8,["loading"]),l(_,{color:"error",onClick:e[7]||(e[7]=a=>t.dialog=!1),disabled:t.submitting},{default:s(()=>[ie]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1},8,["modelValue"])]))}};export{ke as default};
