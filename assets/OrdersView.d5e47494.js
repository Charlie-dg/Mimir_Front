import{k as g,o as u,c as _,a as e,w as s,V as h,bj as y,S as f,g as i,b as t,F as V,r as w,ae as x,D as m,t as n,h as j,ad as p}from"./index.27b69ee7.js";import{V as D}from"./VDialog.cacb8f6d.js";import{V as v}from"./VTable.71ab8437.js";import{V as P}from"./VForm.3c410ef9.js";import{b as S,V as B,a as T}from"./VCard.7443fd38.js";import"./scopeId.69c4e40b.js";import"./form.087d5721.js";import"./VOverlay.93b53304.js";import"./createSimpleFunctional.616bb8bf.js";import"./VAvatar.fe632a7b.js";const $={id:"admin-orders"},z=t("h1",{class:"text-center my-2"},"\u8A02\u55AE\u7BA1\u7406",-1),A=t("thead",null,[t("tr",null,[t("th",{class:"text-center text-h6"},"\u7DE8\u865F"),t("th",{class:"text-center text-h6"},"\u55AE\u865F"),t("th",{class:"text-center text-h6"},"\u65E5\u671F"),t("th",{class:"text-center text-h6"},"\u6703\u54E1\u5E33\u865F"),t("th",{class:"text-center text-h6"},"\u91D1\u984D"),t("th",{class:"text-center text-h6"},"\u67E5\u770B"),t("th",{class:"text-center text-h6"},"\u522A\u9664")])],-1),E={class:"text-center"},F={class:"text-center"},L={class:"text-center"},N={class:"text-center"},q={class:"text-center"},O=p("mdi-eye"),U=p("mdi-delete"),I={key:1},R=t("td",{class:"text-center",colspan:"3"},"\u6C92\u6709\u8A02\u55AE",-1),G=[R],H=p("mdi-close"),J={class:"text-h5 font-weight-bold"},K={class:"text-h6 font-weight-bold"},M={class:"text-h6 font-weight-bold"},Q={class:"text-h6 font-weight-bold"},W=t("div",{class:"text-h6 font-weight-bold"},"\u8A02\u8CFC\u5546\u54C1 :",-1),X=t("thead",null,[t("tr",null,[t("th",{class:"text-center text-h6 font-weight-bold"},"\u5546\u54C1\u540D\u7A31"),t("th",{class:"text-center text-h6 font-weight-bold"},"\u5546\u54C1\u50F9\u683C"),t("th",{class:"text-center text-h6 font-weight-bold"},"\u8CFC\u8CB7\u6578\u91CF")])],-1),Y={cols:"8"},Z={class:"text-center text-subtitle-1"},tt={class:"text-center text-subtitle-1"},et={class:"text-center text-subtitle-1"},ft={__name:"OrdersView",setup(st){const r=g([]),o=g({_id:"",date:"",account:"",totalPrice:0,products:{},idx:-1,dialog:!1,valid:!1}),b=(c,a)=>{o._id=c,a>-1&&(o.date=r[a].date,o.account=r[a].user.account,o.totalPrice=r[a].totalPrice,o.products=r[a].products),o.idx=a,o.dialog=!0,o.valid=!1},k=async(c,a)=>{try{if(c.length!==0){const{data:l}=await y.delete("/orders/"+c);r.splice(a,1),f.fire({icon:"success",title:"\u6210\u529F",text:"\u522A\u9664\u6210\u529F"})}}catch(l){f.fire({icon:"error",title:"\u5931\u6557",text:l.isAxiosError?l.response.data.message:l.message})}};return(async()=>{try{const{data:c}=await y.get("/orders/all");r.push(...c.result.map(a=>(a.totalPrice=a.products.reduce((l,d)=>l+d.product.price*d.quantity,0),a)))}catch(c){console.log(c),f.fire({icon:"error",title:"\u5931\u6557",text:c.isAxiosError?c.response.data.message:c.message})}})(),(c,a)=>(u(),_("div",$,[e(h,{class:"justify-center"},{default:s(()=>[e(i,{cols:"9"},{default:s(()=>[z]),_:1}),e(i,{cols:"9"},{default:s(()=>[e(h,{class:"justify-end align-center",style:{height:"150px"}})]),_:1}),e(i,{cols:"9"},{default:s(()=>[e(v,null,{default:s(()=>[A,t("tbody",null,[r.length>0?(u(!0),_(V,{key:0},w(r,(l,d)=>(u(),_("tr",{key:l._id},[t("td",E,n(d+1),1),t("td",F,n(l._id),1),t("td",L,n(new Date(l.date).toLocaleDateString()),1),t("td",N,n(l.user.account),1),t("td",q,n(l.totalPrice),1),t("td",null,[e(h,{class:"justify-center align-center"},{default:s(()=>[e(x,{onClick:C=>b(l._id,d),style:{width:"2rem",height:"2rem"},icon:"",variant:"text"},{default:s(()=>[e(m,{style:{"font-size":"large"},color:"purple lighten-2"},{default:s(()=>[O]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),t("td",null,[e(h,{class:"justify-center align-center"},{default:s(()=>[e(x,{onClick:C=>k(l._id,d),style:{width:"2rem",height:"2rem"},icon:"",variant:"text"},{default:s(()=>[e(m,{style:{"font-size":"large"},color:"red lighten-2"},{default:s(()=>[U]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]))),128)):(u(),_("tr",I,G))])]),_:1})]),_:1})]),_:1}),e(D,{modelValue:o.dialog,"onUpdate:modelValue":a[2]||(a[2]=l=>o.dialog=l),persistent:""},{default:s(()=>[e(P,{modelValue:o.valid,"onUpdate:modelValue":a[1]||(a[1]=l=>o.valid=l)},{default:s(()=>[e(S,null,{default:s(()=>[e(i,{class:"d-flex justify-end"},{default:s(()=>[e(x,{icon:"",variant:"text",size:"x-small",onClick:a[0]||(a[0]=l=>o.dialog=!1)},{default:s(()=>[e(m,null,{default:s(()=>[H]),_:1})]),_:1})]),_:1}),e(B,{class:"text-center my-2"},{default:s(()=>[t("div",J,"\u8A02\u55AE\u7DE8\u865F : "+n(o._id),1)]),_:1}),e(T,null,{default:s(()=>[e(j,null,{default:s(()=>[e(h,{class:"justify-center"},{default:s(()=>[e(i,{cols:"10"},{default:s(()=>[t("div",K,"\u8A02\u8CFC\u65E5\u671F : "+n(new Date(o.date).toLocaleDateString()),1)]),_:1}),e(i,{cols:"10"},{default:s(()=>[t("div",M,"\u6703\u54E1\u5E33\u865F : "+n(o.account),1)]),_:1}),e(i,{cols:"10"},{default:s(()=>[t("div",Q,"\u8A02\u55AE\u91D1\u984D : $:"+n(o.totalPrice),1)]),_:1}),e(i,{class:"d-flex justify-center",cols:"10"},{default:s(()=>[e(h,null,{default:s(()=>[e(i,{class:"justify-start",cols:"2"},{default:s(()=>[W]),_:1}),e(i,{class:"justify-center",cols:"10"},{default:s(()=>[e(v,{height:"300px"},{default:s(()=>[X,t("tbody",null,[(u(!0),_(V,null,w(o.products,(l,d)=>(u(),_("tr",Y,[t("th",Z,n(l.product.name),1),t("th",tt,n(l.product.price),1),t("th",et,n(l.quantity),1)]))),256))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]))}};export{ft as default};
