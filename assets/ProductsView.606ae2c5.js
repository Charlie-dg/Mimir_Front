import{B as ne,A as _e,x as V,G as se,am as oe,a as t,a9 as z,I as be,an as ke,aq as Ce,v as ve,r as k,F as A,bh as ce,aA as ae,aH as we,bi as Se,Z as M,y as Fe,K as de,a6 as Be,bj as Pe,ad as $e,aY as ze,l as Z,o as D,c as H,w as o,V as T,bg as J,S as j,d as B,i as L,k as le,b as d,n as Ie,b8 as Re,t as Q,bf as Ae,h as K,f as Ne,g as fe}from"./index.87841fbf.js";import{d as Ue,c as De,V as He,e as Te,b as je}from"./VDialog.2e75c69d.js";import{V as Ee}from"./VTable.02dfef2d.js";import{V as Ge}from"./VForm.246dd40a.js";import{m as ie,f as re,b as ue,c as ge,d as he,e as xe,g as pe,a as me}from"./VTextField.db3b7119.js";import{m as qe,f as Me,c as Le,b as Ke,a as Oe}from"./VSelect.263e0be0.js";import{f as Ve}from"./form.4ef7da35.js";import"./createSimpleFunctional.e14f680e.js";import"./VAvatar.429a3ec8.js";import"./scopeId.6899c551.js";import"./VOverlay.dc345b3e.js";import"./VList.480adf03.js";import"./VDivider.d7425a1b.js";const Ye=ne({name:"VCheckbox",inheritAttrs:!1,props:{...ie(),...qe()},setup(e,y){let{attrs:c,slots:a}=y;const u=_e(),f=V(()=>e.id||`checkbox-${u}`);return se(()=>{const[v,P]=oe(c),[I,s]=re(e),[l,n]=Me(e);return t(ue,z({class:"v-checkbox"},v,I,{id:f.value}),{...a,default:g=>{let{id:p,isDisabled:_,isReadonly:x}=g;return t(Le,z(l,{id:p.value,disabled:_.value,readonly:x.value},P),a)}})}),{}}});const Ze=ne({name:"VFileInput",inheritAttrs:!1,props:{chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,hint:String,persistentHint:Boolean,placeholder:String,showSize:{type:[Boolean,Number],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(e)},...ie(),prependIcon:{type:be,default:"$file"},modelValue:{type:Array,default:()=>[],validator:e=>ke(e).every(y=>y!=null&&typeof y=="object")},...ge({clearable:!0})},emits:{"click:clear":e=>!0,"click:control":e=>!0,"update:modelValue":e=>!0},setup(e,y){let{attrs:c,emit:a,slots:u}=y;const{t:f}=Ce(),v=ve(e,"modelValue"),P=V(()=>typeof e.showSize!="boolean"?e.showSize:void 0),I=V(()=>{var r;return((r=v.value)!=null?r:[]).reduce((m,h)=>{let{size:i=0}=h;return m+i},0)}),s=V(()=>ce(I.value,P.value)),l=V(()=>{var r;return((r=v.value)!=null?r:[]).map(m=>{const{name:h="",size:i=0}=m;return e.showSize?`${h} (${ce(i,P.value)})`:h})}),n=V(()=>{var r,m;const h=(r=(m=v.value)==null?void 0:m.length)!=null?r:0;return e.showSize?f(e.counterSizeString,h,s.value):f(e.counterString,h)}),g=k(),p=k(),_=k(!1),x=k(),E=V(()=>e.messages.length?e.messages:e.persistentHint?e.hint:"");function G(){if(x.value!==document.activeElement){var r;(r=x.value)==null||r.focus()}_.value||(_.value=!0)}function O(r){var m;(m=x.value)==null||m.click(),a("click:control",r)}function W(r){r.stopPropagation(),G(),ae(()=>{v.value=[],x!=null&&x.value&&(x.value.value=""),a("click:clear",r)})}return se(()=>{const r=!!(u.counter||e.counter),m=!!(r||u.details),[h,i]=oe(c),[{modelValue:C,...b}]=re(e),[w]=he(e);return t(ue,z({ref:g,modelValue:v.value,"onUpdate:modelValue":S=>v.value=S,class:"v-file-input"},h,b,{"onClick:prepend":O,messages:E.value}),{...u,default:S=>{let{isDisabled:$,isDirty:N,isReadonly:R,isValid:U}=S;return t(xe,z({ref:p,"prepend-icon":e.prependIcon,"onClick:control":O,"onClick:clear":W},w,{active:N.value||_.value,dirty:N.value,focused:_.value,error:U.value===!1}),{...u,default:Y=>{let{props:{class:X,...ee}}=Y;return t(A,null,[t("input",z({ref:x,type:"file",readonly:R.value,disabled:$.value,multiple:e.multiple,name:e.name,onClick:F=>{F.stopPropagation(),G()},onChange:F=>{var q;if(!F.target)return;const te=F.target;v.value=[...(q=te.files)!=null?q:[]]},onFocus:G,onBlur:()=>_.value=!1},ee,i),null),v.value.length>0&&t("div",{class:X},[u.selection?u.selection({fileNames:l.value,totalBytes:I.value,totalBytesReadable:s.value}):e.chips?l.value.map(F=>t(Ke,{key:F,size:"small",color:e.color},{default:()=>[F]})):l.value.join(", ")])])}})},details:m?S=>{var $;return t(A,null,[($=u.details)==null?void 0:$.call(u,S),r&&t(A,null,[t("span",null,null),t(pe,{active:!!v.value.length,value:n.value},u.counter)])])}:void 0})}),Ve({},g,p,x)}});const Je=ne({name:"VTextarea",directives:{Intersect:we},inheritAttrs:!1,props:{autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,hint:String,persistentHint:Boolean,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,...ie(),...ge()},emits:{"click:clear":e=>!0,"click:control":e=>!0,"update:modelValue":e=>!0},setup(e,y){let{attrs:c,emit:a,slots:u}=y;const f=ve(e,"modelValue"),v=V(()=>typeof e.counterValue=="function"?e.counterValue(f.value):(f.value||"").toString().length),P=V(()=>{if(c.maxlength)return c.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function I(i,C){var b,w;!e.autofocus||!i||(b=C[0].target)==null||(w=b.focus)==null||w.call(b)}const s=k(),l=k(),n=k(!1),g=k(""),p=k(),_=V(()=>n.value||e.persistentPlaceholder),x=V(()=>e.messages.length?e.messages:_.value||e.persistentHint?e.hint:"");function E(){if(p.value!==document.activeElement){var i;(i=p.value)==null||i.focus()}n.value||(n.value=!0)}function G(i){E(),a("click:control",i)}function O(i){i.stopPropagation(),E(),ae(()=>{f.value="",a("click:clear",i)})}function W(i){f.value=i.target.value}const r=k();function m(){!e.autoGrow||ae(()=>{if(!r.value||!l.value)return;const i=getComputedStyle(r.value),C=getComputedStyle(l.value.$el),b=parseFloat(i.getPropertyValue("--v-field-padding-top"))+parseFloat(i.getPropertyValue("--v-input-padding-top"))+parseFloat(i.getPropertyValue("--v-field-padding-bottom")),w=r.value.scrollHeight,S=parseFloat(i.lineHeight),$=Math.max(parseFloat(e.rows)*S+b,parseFloat(C.getPropertyValue("--v-input-control-height"))),N=parseFloat(e.maxRows)*S+b||1/0;g.value=$e(ze(w!=null?w:0,$,N))})}Se(m),M(f,m),M(()=>e.rows,m),M(()=>e.maxRows,m),M(()=>e.density,m);let h;return M(r,i=>{if(i)h=new ResizeObserver(m),h.observe(r.value);else{var C;(C=h)==null||C.disconnect()}}),Fe(()=>{var i;(i=h)==null||i.disconnect()}),se(()=>{const i=!!(u.counter||e.counter||e.counterValue),C=!!(i||u.details),[b,w]=oe(c),[{modelValue:S,...$}]=re(e),[N]=he(e);return t(ue,z({ref:s,modelValue:f.value,"onUpdate:modelValue":R=>f.value=R,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow}]},b,$,{messages:x.value}),{...u,default:R=>{let{isDisabled:U,isDirty:Y,isReadonly:X,isValid:ee}=R;return t(xe,z({ref:l,style:{"--v-textarea-control-height":g.value},"onClick:control":G,"onClick:clear":O,role:"textbox"},N,{active:_.value||Y.value,dirty:Y.value||e.dirty,focused:n.value,error:ee.value===!1}),{...u,default:F=>{let{props:{class:q,...te}}=F;return t(A,null,[e.prefix&&t("span",{class:"v-text-field__prefix"},[e.prefix]),de(t("textarea",z({ref:p,class:q,value:f.value,onInput:W,autofocus:e.autofocus,readonly:X.value,disabled:U.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:E,onBlur:()=>n.value=!1},te,w),null),[[Be("intersect"),{handler:I},null,{once:!0}]]),e.autoGrow&&de(t("textarea",{class:[q,"v-textarea__sizer"],"onUpdate:modelValue":ye=>f.value=ye,ref:r,readonly:!0,"aria-hidden":"true"},null),[[Pe,f.value]]),e.suffix&&t("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:C?R=>{var U;return t(A,null,[(U=u.details)==null?void 0:U.call(u,R),i&&t(A,null,[t("span",null,null),t(pe,{active:e.persistentCounter||n.value,value:v.value,max:P.value},u.counter)])])}:void 0})}),Ve({},s,l,p)}}),Qe={id:"admin-products"},We=d("h1",{class:"text-center my-2"},"\u5546\u54C1\u7BA1\u7406",-1),Xe=K("mdi-plus"),et=d("thead",null,[d("tr",null,[d("th",{class:"text-center text-h6"},"\u7DE8\u865F"),d("th",{class:"text-center text-h6"},"\u5716\u7247"),d("th",{class:"text-center text-h6"},"\u540D\u7A31"),d("th",{class:"text-center text-h6"},"\u7A2E\u985E"),d("th",{class:"text-center text-h6"},"\u4E0A\u67B6"),d("th",{class:"text-center text-h6"},"\u7DE8\u8F2F"),d("th",{class:"text-center text-h6"},"\u522A\u9664")])],-1),tt={class:"text-center"},lt={class:"text-center"},at={class:"text-center"},nt={key:0,class:"text-center"},st={key:1,class:"text-center"},ot=K("mdi-pencil-outline"),it=K("mdi-delete"),rt={key:1},ut=d("td",{class:"text-center",colspan:"3"},"\u6C92\u6709\u5546\u54C1",-1),ct=[ut],dt={class:"text-h5"},ft=K("\u78BA\u5B9A"),mt=K("\u53D6\u6D88"),Ft={__name:"ProductsView",setup(e){const y=Z(["\u6D17\u9AEE\u7CFB\u5217","\u8B77\u9AEE\u7CFB\u5217","\u9020\u578B\u68B3","\u9020\u578B\u593E","\u96FB\u6372\u68D2","\u5439\u98A8\u6A5F"]),c=Z([]),a=Z({_id:"",name:"",price:0,sell:!1,category:"",image:"",description:"",idx:-1,dialog:!1,valid:!1,submitting:!1}),u=Z({required(s){return!!s||"\u5FC5\u586B"},price(s){return s>-1||"\u5FC5\u9808\u5927\u65BC\u7B49\u65BC 0"},size(s){var l,n,g;return!s||!s.length||((n=(l=s[0])==null?void 0:l.type)==null?void 0:n.includes("image"))&&((g=s[0])==null?void 0:g.size)<1024*1024||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26"}}),f=(s,l)=>{a._id=s,l>-1?(a.name=c[l].name,a.price=c[l].price,a.sell=c[l].sell,a.category=c[l].category,a.description=c[l].description):(a.name="",a.price=0,a.sell=!1,a.category="",a.description=""),a.image=[],a.idx=l,a.dialog=!0,a.valid=!1,a.submitting=!1},v=async()=>{if(!a.valid)return;a.submitting=!0;const s=new FormData;for(const l in a)["_id","idx","dialog","valid","submitting"].includes(l)||(l==="image"?s.append(l,a[l][0]):s.append(l,a[l]));try{if(a._id.length===0){const{data:l}=await J.post("/products",s);c.push(l.result),j.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:l}=await J.patch("/products/"+a._id,s);console.log(s.name),c[a.idx]=l.result,j.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}a.dialog=!1}catch(l){j.fire({icon:"error",title:"\u5931\u6557",text:l.isAxiosError?l.response.data.message:l.message})}a.submitting=!1},P=async(s,l)=>{try{if(s.length!==0){const{data:n}=await J.delete("/products/"+s);c.splice(l,1),j.fire({icon:"success",title:"\u6210\u529F",text:"\u522A\u9664\u6210\u529F"})}}catch(n){j.fire({icon:"error",title:"\u5931\u6557",text:n.isAxiosError?n.response.data.message:n.message})}};return(async()=>{try{const{data:s}=await J.get("/products/all");c.push(...s.result)}catch(s){console.log(s),j.fire({icon:"error",title:"\u5931\u6557",text:s.isAxiosError?s.response.data.message:s.message})}})(),(s,l)=>(D(),H("div",Qe,[t(T,{class:"justify-center"},{default:o(()=>[t(B,{cols:"9"},{default:o(()=>[We]),_:1}),t(B,{cols:"9"},{default:o(()=>[t(T,{class:"justify-end align-center",style:{height:"150px"}},{default:o(()=>[t(L,{icon:"",variant:"text",onClick:l[0]||(l[0]=n=>f("",-1))},{default:o(()=>[t(le,{color:"green lighten-2"},{default:o(()=>[Xe]),_:1})]),_:1})]),_:1})]),_:1}),t(B,{cols:"9"},{default:o(()=>[t(Ee,null,{default:o(()=>[et,d("tbody",null,[c.length>0?(D(!0),H(A,{key:0},Ie(c,(n,g)=>(D(),H("tr",{key:n._id},[d("td",tt,Q(g+1),1),d("td",null,[t(Ne,{src:n.image},null,8,["src"])]),d("td",lt,Q(n.name),1),d("td",at,Q(n.category),1),n.sell===!0?(D(),H("td",nt,"\u5DF2\u4E0A\u67B6")):fe("",!0),n.sell===!1?(D(),H("td",st,"\u672A\u4E0A\u67B6")):fe("",!0),d("td",null,[t(T,{class:"justify-center"},{default:o(()=>[t(L,{onClick:p=>f(n._id,g),style:{width:"2rem",height:"2rem"},icon:"",variant:"text"},{default:o(()=>[t(le,{style:{"font-size":"large"},color:"blue lighten-2"},{default:o(()=>[ot]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),d("td",null,[t(T,{class:"justify-center align-center"},{default:o(()=>[t(L,{onClick:p=>P(n._id,g),style:{width:"2rem",height:"2rem"},icon:"",variant:"text"},{default:o(()=>[t(le,{style:{"font-size":"large"},color:"red lighten-2"},{default:o(()=>[it]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]))),128)):(D(),H("tr",rt,ct))])]),_:1})]),_:1})]),_:1}),t(Ue,{modelValue:a.dialog,"onUpdate:modelValue":l[9]||(l[9]=n=>a.dialog=n),persistent:""},{default:o(()=>[t(Ge,{modelValue:a.valid,"onUpdate:modelValue":l[8]||(l[8]=n=>a.valid=n),onSubmit:Re(v,["prevent"])},{default:o(()=>[t(De,null,{default:o(()=>[t(He,{class:"text-center my-4"},{default:o(()=>[d("div",dt,Q(a._id.length>0?"\u7DE8\u8F2F\u5546\u54C1":"\u65B0\u589E\u5546\u54C1"),1)]),_:1}),t(Te,null,{default:o(()=>[t(Ae,null,{default:o(()=>[t(T,{class:"justify-center"},{default:o(()=>[t(B,{cols:"9"},{default:o(()=>[t(me,{modelValue:a.name,"onUpdate:modelValue":l[1]||(l[1]=n=>a.name=n),label:"\u540D\u7A31",rules:[u.required]},null,8,["modelValue","rules"])]),_:1}),t(B,{cols:"9"},{default:o(()=>[t(me,{type:"number",min:"0",modelValue:a.price,"onUpdate:modelValue":l[2]||(l[2]=n=>a.price=n),label:"\u50F9\u683C",rules:[u.required,u.price]},null,8,["modelValue","rules"])]),_:1}),t(B,{cols:"9"},{default:o(()=>[t(Ye,{modelValue:a.sell,"onUpdate:modelValue":l[3]||(l[3]=n=>a.sell=n),label:"\u4E0A\u67B6"},null,8,["modelValue"])]),_:1}),t(B,{cols:"9"},{default:o(()=>[t(Oe,{items:y,modelValue:a.category,"onUpdate:modelValue":l[4]||(l[4]=n=>a.category=n),label:"\u5206\u985E",rules:[u.required]},null,8,["items","modelValue","rules"])]),_:1}),t(B,{cols:"9"},{default:o(()=>[t(Ze,{modelValue:a.image,"onUpdate:modelValue":l[5]||(l[5]=n=>a.image=n),"show-size":"",accept:"image/*",label:"\u5546\u54C1\u5716\u7247","prepend-icon":"",outlined:"",rules:[u.size]},null,8,["modelValue","rules"])]),_:1}),t(B,{cols:"9"},{default:o(()=>[t(Je,{modelValue:a.description,"onUpdate:modelValue":l[6]||(l[6]=n=>a.description=n),label:"\u5546\u54C1\u4ECB\u7D39"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(je,null,{default:o(()=>[t(T,{class:"justify-center"},{default:o(()=>[t(L,{type:"submit",color:"primary",loading:a.submitting},{default:o(()=>[ft]),_:1},8,["loading"]),t(L,{color:"error",onClick:l[7]||(l[7]=n=>a.dialog=!1),disabled:a.submitting},{default:o(()=>[mt]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1},8,["modelValue"])]))}};export{Ft as default};
