import{r as b,o as u,c as p,a as l,w as s,V as c,bk as V,S as _,d,L as f,Z as h,g as i,F as C,e as j,f as v,h as z,l as F,t as g,s as S,m as T,X as D,bd as E,j as I,i as k,n as N,W as m,k as U,p as G,q as L}from"./index.bd4fd932.js";import{V as M}from"./VDialog.bfeb72b8.js";import{V as P}from"./VTable.abe4eba5.js";import{a as R}from"./VTextField.8a73386a.js";import{V as W,a as $}from"./VTextarea.9a5dcdc6.js";import{V as X}from"./VCheckbox.150923dc.js";import{V as A}from"./VForm.c3d7715b.js";import"./scopeId.151d1840.js";import"./easing.1a8f6470.js";import"./form.c4e01d6d.js";import"./VOverlay.2f2e3911.js";import"./VCheckboxBtn.8db5c78e.js";const Z={id:"admin-designers"},H=i("h1",{class:"text-center my-2"},"\u5718\u968A\u7BA1\u7406",-1),J=m("mdi-plus"),K=i("thead",null,[i("tr",null,[i("th",{class:"text-center text-h6"},"\u7DE8\u865F"),i("th",{class:"text-center text-h6"},"\u982D\u50CF"),i("th",{class:"text-center text-h6"},"\u59D3\u540D"),i("th",{class:"text-center text-h6"},"\u767C\u4F48"),i("th",{class:"text-center text-h6"},"\u67E5\u770B"),i("th",{class:"text-center text-h6"},"\u7DE8\u8F2F"),i("th",{class:"text-center text-h6"},"\u522A\u9664")])],-1),O={class:"text-center"},Q={class:"text-center"},Y={key:0,class:"text-center"},ee={key:1,class:"text-center"},te=m("mdi-eye"),le=m("mdi-pencil-outline"),se=m("mdi-delete"),ae={key:1},oe=i("td",{class:"text-center text-h6",colspan:"7"},"\u5C1A\u7121\u8A2D\u8A08\u5E2B",-1),ie=[oe],ne=m("mdi-close"),re={class:"text-h5"},de=m("\u78BA\u5B9A"),ue=m("\u53D6\u6D88"),ce=m("mdi-close"),fe={class:"text-h5 font-weight-bold"},me=i("div",{class:"text-h6 font-weight-bold text-center"},"\u7C21\u4ECB:",-1),pe={class:"text-h6 font-weight-bold text-center my-2"},_e=i("div",{class:"text-h6 font-weight-bold text-center my-2"},"\u4F5C\u54C1\u96C6:",-1),he={class:"portfolio",style:{width:"80%",height:"50%"}},Ue={__name:"TeamView",setup(ge){const n=b([]),e=b({_id:"",name:"",description:"",avatar:"",portfolio:[],publish:!1,idx:-1,dialog:!1,read:!1,valid:!1,submitting:!1}),x=b({required(o){return!!o||"\u5FC5\u586B"},size(o){var t,a,r;return!o||!o.length||((a=(t=o[0])==null?void 0:t.type)==null?void 0:a.includes("image"))&&((r=o[0])==null?void 0:r.size)<1024*1024||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26"}}),y=(o,t,a)=>{if(e._id=o,a){e.name=n[t].name,e.description=n[t].description,e.publish=n[t].publish,e.avatar=n[t].avatar;for(const r in n[t].portfolio)e.portfolio[r]=n[t].portfolio[r];e.read=!0}else t>-1?(e.name=n[t].name,e.description=n[t].description,e.publish=n[t].publish,e.avatar=[],e.portfolio=[]):(e.name="",e.description="",e.publish=!1,e.avatar=[],e.portfolio=[]),e.read=!1;e.idx=t,e.dialog=!0,e.valid=!1,e.submitting=!1},B=async()=>{if(!e.valid)return;e.submitting=!0;const o=new FormData;for(const t in e)if(!["_id","idx","dialog","valid","submitting"].includes(t))if(t==="avatar")o.append(t,e[t][0]);else if(t==="portfolio")for(const a in e[t])o.append(t,e[t][a]);else o.append(t,e[t]);try{if(e._id.length===0){const{data:t}=await V.post("/designers",o);n.push(t.result),_.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:t}=await V.patch("/designers/"+e._id,o);n[e.idx]=t.result,_.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(t){_.fire({icon:"error",title:"\u5931\u6557",text:t.isAxiosError?t.response.data.message:t.message})}e.submitting=!1},q=async(o,t)=>{try{if(o.length!==0){const{data:a}=await V.delete("/designers/"+o);n.splice(t,1),_.fire({icon:"success",title:"\u6210\u529F",text:"\u522A\u9664\u6210\u529F"})}}catch(a){_.fire({icon:"error",title:"\u5931\u6557",text:a.isAxiosError?a.response.data.message:a.message})}};return(async()=>{try{const{data:o}=await V.get("/designers/all");n.push(...o.result)}catch(o){console.log(o),_.fire({icon:"error",title:"\u5931\u6557",text:o.isAxiosError?o.response.data.message:o.message})}})(),(o,t)=>(u(),p("div",Z,[l(c,{class:"justify-center"},{default:s(()=>[l(d,{cols:"9"},{default:s(()=>[H]),_:1}),l(d,{cols:"9"},{default:s(()=>[l(c,{class:"justify-end align-center",style:{height:"150px"}},{default:s(()=>[l(f,{icon:"",variant:"text",onClick:t[0]||(t[0]=a=>y("",-1))},{default:s(()=>[l(h,{color:"green lighten-2"},{default:s(()=>[J]),_:1})]),_:1})]),_:1})]),_:1}),l(d,{cols:"9"},{default:s(()=>[l(P,null,{default:s(()=>[K,i("tbody",null,[n.length>0?(u(!0),p(C,{key:0},j(n,(a,r)=>(u(),p("tr",{key:a._id},[i("td",O,g(r+1),1),i("td",null,[l(k,{src:a.avatar},null,8,["src"])]),i("td",Q,g(a.name),1),a.publish===!0?(u(),p("td",Y,"\u5DF2\u767C\u4F48")):U("",!0),a.publish===!1?(u(),p("td",ee,"\u672A\u767C\u4F48")):U("",!0),i("td",null,[l(c,{class:"justify-center align-center"},{default:s(()=>[l(f,{onClick:w=>y(a._id,r,!0),style:{width:"2rem",height:"2rem"},icon:"",variant:"text"},{default:s(()=>[l(h,{style:{"font-size":"large"},color:"purple lighten-2"},{default:s(()=>[te]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),i("td",null,[l(c,{class:"justify-center"},{default:s(()=>[l(f,{onClick:w=>y(a._id,r,!1),style:{width:"2rem",height:"2rem"},icon:"",variant:"text"},{default:s(()=>[l(h,{style:{"font-size":"large"},color:"blue lighten-2"},{default:s(()=>[le]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),i("td",null,[l(c,{class:"justify-center align-center"},{default:s(()=>[l(f,{onClick:w=>q(a._id,r),style:{width:"2rem",height:"2rem"},icon:"",variant:"text"},{default:s(()=>[l(h,{style:{"font-size":"large"},color:"red lighten-2"},{default:s(()=>[se]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]))),128)):(u(),p("tr",ae,ie))])]),_:1})]),_:1})]),_:1}),l(M,{modelValue:e.dialog,"onUpdate:modelValue":t[10]||(t[10]=a=>e.dialog=a),persistent:""},{default:s(()=>[e.read?(u(),v(A,{key:1},{default:s(()=>[l(z,{style:{width:"600px"}},{default:s(()=>[l(d,{class:"d-flex justify-end"},{default:s(()=>[l(f,{icon:"",variant:"text",size:"x-small",onClick:t[9]||(t[9]=a=>e.dialog=!1)},{default:s(()=>[l(h,null,{default:s(()=>[ce]),_:1})]),_:1})]),_:1}),l(d,{class:"d-flex justify-center"},{default:s(()=>[l(I,{size:"250px"},{default:s(()=>[l(k,{src:e.avatar},null,8,["src"])]),_:1})]),_:1}),l(F,{class:"text-center my-2"},{default:s(()=>[i("div",fe,g(e.name),1)]),_:1}),l(S,null,{default:s(()=>[l(T,null,{default:s(()=>[l(c,{class:"justify-center align-center"},{default:s(()=>[l(d,{cols:"10"},{default:s(()=>[me,i("div",pe,g(e.description),1)]),_:1})]),_:1}),l(c,{class:"justify-center align-center",style:{height:"50px"}},{default:s(()=>[_e]),_:1}),l(c,{class:"justify-center align-center"},{default:s(()=>[i("div",he,[l(N,{class:"pa-4","show-arrows":!0},{default:s(()=>[(u(!0),p(C,null,j(e.portfolio,(a,r)=>(u(),v(G,{key:r+1},{default:s(()=>[l(k,{src:a,class:L(o.m-4),style:{width:"200px",height:"200px"}},null,8,["src","class"])]),_:2},1024))),128))]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):(u(),v(A,{key:0,modelValue:e.valid,"onUpdate:modelValue":t[8]||(t[8]=a=>e.valid=a),onSubmit:E(B,["prevent"])},{default:s(()=>[l(z,null,{default:s(()=>[l(d,{class:"d-flex justify-end"},{default:s(()=>[l(f,{icon:"",variant:"text",size:"x-small",onClick:t[1]||(t[1]=a=>e.dialog=!1)},{default:s(()=>[l(h,null,{default:s(()=>[ne]),_:1})]),_:1})]),_:1}),l(F,{class:"text-center my-4"},{default:s(()=>[i("div",re,g(e._id.length>0?"\u7DE8\u8F2F\u8A2D\u8A08\u5E2B":"\u65B0\u589E\u8A2D\u8A08\u5E2B"),1)]),_:1}),l(S,null,{default:s(()=>[l(T,null,{default:s(()=>[l(c,{class:"justify-center"},{default:s(()=>[l(d,{cols:"9"},{default:s(()=>[l(R,{modelValue:e.name,"onUpdate:modelValue":t[2]||(t[2]=a=>e.name=a),label:"\u540D\u7A31",rules:[x.required]},null,8,["modelValue","rules"])]),_:1}),l(d,{cols:"9"},{default:s(()=>[l(W,{modelValue:e.description,"onUpdate:modelValue":t[3]||(t[3]=a=>e.description=a),label:"\u7C21\u4ECB",rules:[x.required]},null,8,["modelValue","rules"])]),_:1}),l(d,{cols:"9"},{default:s(()=>[l(X,{modelValue:e.publish,"onUpdate:modelValue":t[4]||(t[4]=a=>e.publish=a),label:"\u767C\u4F48"},null,8,["modelValue"])]),_:1}),l(d,{cols:"9"},{default:s(()=>[l($,{modelValue:e.avatar,"onUpdate:modelValue":t[5]||(t[5]=a=>e.avatar=a),"show-size":"",accept:"avatar/*",label:"\u982D\u50CF","prepend-icon":"mdi-camera",outlined:"",rules:[x.size]},null,8,["modelValue","rules"])]),_:1}),l(d,{cols:"9"},{default:s(()=>[l($,{multiple:"",modelValue:e.portfolio,"onUpdate:modelValue":t[6]||(t[6]=a=>e.portfolio=a),"show-size":"",accept:"portfolio/*",label:"\u4F5C\u54C1\u96C6","prepend-icon":"mdi-image-multiple",outlined:"",rules:[x.size]},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),l(D,null,{default:s(()=>[l(c,{class:"justify-center"},{default:s(()=>[l(f,{type:"submit",color:"primary",loading:e.submitting},{default:s(()=>[de]),_:1},8,["loading"]),l(f,{color:"error",onClick:t[7]||(t[7]=a=>e.dialog=!1),disabled:e.submitting},{default:s(()=>[ue]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"]))]),_:1},8,["modelValue"])]))}};export{Ue as default};
