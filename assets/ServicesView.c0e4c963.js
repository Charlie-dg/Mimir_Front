import{r as h,o as c,c as u,a as s,w as l,V as m,bf as x,S as f,d as n,L as _,W as V,g as i,F as S,e as U,bd as F,h as q,l as A,t as p,s as $,m as B,Z as D,X as g,k}from"./index.47334d42.js";import{V as E}from"./VDialog.7f420c25.js";import{V as N}from"./VTable.5b66a91b.js";import{V as z}from"./VForm.b91d8aab.js";import{a as b}from"./VTextField.0b70c3b0.js";import{V as L}from"./VSelect.9ce7e4f9.js";import{V as I}from"./VCheckbox.d0bc06ba.js";import"./scopeId.49699c11.js";import"./easing.1a8f6470.js";import"./form.4c0a7941.js";import"./VOverlay.cdc8c9f8.js";import"./VList.faee9f83.js";import"./VCheckboxBtn.2718bb36.js";const M={id:"admin-services"},P=i("h1",{class:"text-center my-2"},"\u670D\u52D9\u7BA1\u7406",-1),R=g("mdi-plus"),W=i("thead",null,[i("tr",null,[i("th",{class:"text-center text-h6"},"\u7DE8\u865F"),i("th",{class:"text-center text-h6"},"\u670D\u52D9\u540D\u7A31"),i("th",{class:"text-center text-h6"},"\u670D\u52D9\u9805\u76EE"),i("th",{class:"text-center text-h6"},"\u50F9\u683C"),i("th",{class:"text-center text-h6"},"\u9810\u8A08\u6642\u9593(hr)"),i("th",{class:"text-center text-h6"},"\u4E0A\u67B6"),i("th",{class:"text-center text-h6"},"\u7DE8\u8F2F"),i("th",{class:"text-center text-h6"},"\u522A\u9664")])],-1),X={class:"text-center"},Z={class:"text-center"},G={class:"text-center"},H={class:"text-center"},J={class:"text-center"},K={key:0,class:"text-center"},O={key:1,class:"text-center"},Q=g("mdi-pencil-outline"),Y=g("mdi-delete"),ee={key:1},te=i("td",{class:"text-center text-h6",colspan:"8"},"\u5C1A\u7121\u670D\u52D9",-1),se=[te],le=g("mdi-close"),ae={class:"text-h5"},oe=g("\u78BA\u5B9A"),ie=g("\u53D6\u6D88"),ve={__name:"ServicesView",setup(re){const C=h(["\u6D17\u9AEE","\u526A\u9AEE","\u67D3\u9AEE","\u71D9\u9AEE","\u8B77\u9AEE"]),r=h([]),t=h({_id:"",name:"",category:"",price:0,costTime:0,sell:!1,idx:-1,dialog:!1,valid:!1,submitting:!1}),d=h({required(o){return!!o||"\u5FC5\u586B"},price(o){return o>-1||"\u5FC5\u9808\u5927\u65BC\u7B49\u65BC 0"},costTime(o){return o>-1||"\u5FC5\u9808\u5927\u65BC\u7B49\u65BC 0"}}),v=(o,e)=>{t._id=o,e>-1?(t.name=r[e].name,t.category=r[e].category,t.price=r[e].price,t.costTime=r[e].costTime,t.sell=r[e].sell):(t.name="",t.category="",t.price=0,t.costTime=0,t.sell=!1),t.idx=e,t.dialog=!0,t.valid=!1,t.submitting=!1},T=async()=>{if(!t.valid)return;t.submitting=!0;const o=new FormData;for(const e in t)["_id","idx","dialog","valid","submitting"].includes(e)||(e==="image"?o.append(e,t[e][0]):o.append(e,t[e]));try{if(t._id.length===0){const{data:e}=await x.post("/services",o);r.push(e.result),f.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:e}=await x.patch("/services/"+t._id,o);console.log(o.name),r[t.idx]=e.result,f.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}t.dialog=!1}catch(e){f.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}t.submitting=!1},w=async(o,e)=>{try{if(o.length!==0){const{data:a}=await x.delete("/services/"+o);r.splice(e,1),f.fire({icon:"success",title:"\u6210\u529F",text:"\u522A\u9664\u6210\u529F"})}}catch(a){f.fire({icon:"error",title:"\u5931\u6557",text:a.isAxiosError?a.response.data.message:a.message})}};return(async()=>{try{const{data:o}=await x.get("/services/all");r.push(...o.result)}catch(o){console.log(o),f.fire({icon:"error",title:"\u5931\u6557",text:o.isAxiosError?o.response.data.message:o.message})}})(),(o,e)=>(c(),u("div",M,[s(m,{class:"justify-center"},{default:l(()=>[s(n,{cols:"9"},{default:l(()=>[P]),_:1}),s(n,{cols:"9"},{default:l(()=>[s(m,{class:"justify-end align-center",style:{height:"150px"}},{default:l(()=>[s(_,{icon:"",variant:"text",onClick:e[0]||(e[0]=a=>v("",-1))},{default:l(()=>[s(V,{color:"green lighten-2"},{default:l(()=>[R]),_:1})]),_:1})]),_:1})]),_:1}),s(n,{cols:"9"},{default:l(()=>[s(N,null,{default:l(()=>[W,i("tbody",null,[r.length>0?(c(!0),u(S,{key:0},U(r,(a,y)=>(c(),u("tr",{key:a._id},[i("td",X,p(y+1),1),i("td",Z,p(a.name),1),i("td",G,p(a.category),1),i("td",H,p(a.price),1),i("td",J,p(a.costTime),1),a.sell===!0?(c(),u("td",K,"\u5DF2\u4E0A\u67B6")):k("",!0),a.sell===!1?(c(),u("td",O,"\u672A\u4E0A\u67B6")):k("",!0),i("td",null,[s(m,{class:"justify-center"},{default:l(()=>[s(_,{onClick:j=>v(a._id,y),style:{width:"2rem",height:"2rem"},icon:"",variant:"text"},{default:l(()=>[s(V,{style:{"font-size":"large"},color:"blue lighten-2"},{default:l(()=>[Q]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),i("td",null,[s(m,{class:"justify-center align-center"},{default:l(()=>[s(_,{onClick:j=>w(a._id,y),style:{width:"2rem",height:"2rem"},icon:"",variant:"text"},{default:l(()=>[s(V,{style:{"font-size":"large"},color:"red lighten-2"},{default:l(()=>[Y]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]))),128)):(c(),u("tr",ee,se))])]),_:1})]),_:1})]),_:1}),s(E,{modelValue:t.dialog,"onUpdate:modelValue":e[9]||(e[9]=a=>t.dialog=a),persistent:""},{default:l(()=>[s(z,{modelValue:t.valid,"onUpdate:modelValue":e[8]||(e[8]=a=>t.valid=a),onSubmit:F(T,["prevent"])},{default:l(()=>[s(q,null,{default:l(()=>[s(n,{class:"d-flex justify-end"},{default:l(()=>[s(_,{icon:"",variant:"text",size:"x-small",onClick:e[1]||(e[1]=a=>t.dialog=!1)},{default:l(()=>[s(V,null,{default:l(()=>[le]),_:1})]),_:1})]),_:1}),s(A,{class:"text-center my-4"},{default:l(()=>[i("div",ae,p(t._id.length>0?"\u7DE8\u8F2F\u670D\u52D9":"\u65B0\u589E\u670D\u52D9"),1)]),_:1}),s($,null,{default:l(()=>[s(B,null,{default:l(()=>[s(m,{class:"justify-center"},{default:l(()=>[s(n,{cols:"9"},{default:l(()=>[s(b,{modelValue:t.name,"onUpdate:modelValue":e[2]||(e[2]=a=>t.name=a),label:"\u670D\u52D9\u540D\u7A31",rules:[d.required]},null,8,["modelValue","rules"])]),_:1}),s(n,{cols:"9"},{default:l(()=>[s(L,{items:C,modelValue:t.category,"onUpdate:modelValue":e[3]||(e[3]=a=>t.category=a),label:"\u670D\u52D9\u9805\u76EE",rules:[d.required]},null,8,["items","modelValue","rules"])]),_:1}),s(n,{cols:"9"},{default:l(()=>[s(b,{type:"number",min:"0",modelValue:t.price,"onUpdate:modelValue":e[4]||(e[4]=a=>t.price=a),label:"\u50F9\u683C",rules:[d.required,d.price]},null,8,["modelValue","rules"])]),_:1}),s(n,{cols:"9"},{default:l(()=>[s(b,{type:"number",min:"0",modelValue:t.costTime,"onUpdate:modelValue":e[5]||(e[5]=a=>t.costTime=a),label:"\u9810\u8A08\u6642\u9593",rules:[d.required,d.costTime]},null,8,["modelValue","rules"])]),_:1}),s(n,{cols:"9"},{default:l(()=>[s(I,{modelValue:t.sell,"onUpdate:modelValue":e[6]||(e[6]=a=>t.sell=a),label:"\u4E0A\u67B6"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),s(D,null,{default:l(()=>[s(m,{class:"justify-center"},{default:l(()=>[s(_,{type:"submit",color:"primary",loading:t.submitting},{default:l(()=>[oe]),_:1},8,["loading"]),s(_,{color:"error",onClick:e[7]||(e[7]=a=>t.dialog=!1),disabled:t.submitting},{default:l(()=>[ie]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1},8,["modelValue"])]))}};export{ve as default};
