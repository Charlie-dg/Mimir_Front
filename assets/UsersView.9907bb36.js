import{l as c,o as g,c as p,a as l,w as a,V as u,bg as b,S as x,d as i,b as n,F as j,n as A,b8 as F,i as m,k as V,bf as S,h as _,t as r}from"./index.1abab4fd.js";import{d as z,c as T,V as $,e as B,b as D}from"./VDialog.6ae4a7ab.js";import{V as E}from"./VTable.d53087bb.js";import{V as N}from"./VForm.177f6fbe.js";import{a as f}from"./VTextField.de84ebcb.js";import{a as v}from"./VSelect.4227a30f.js";import{v as Z}from"./index.d9275255.js";import"./createSimpleFunctional.c0a6c7b6.js";import"./VAvatar.39d795f4.js";import"./scopeId.ec03e723.js";import"./form.612ffd7c.js";import"./VOverlay.6f1acc69.js";import"./VList.284b03ec.js";import"./VDivider.18abc35e.js";const I={id:"admin-orders"},L=n("h1",{class:"text-center my-2"},"\u6703\u54E1\u7BA1\u7406",-1),M=n("thead",null,[n("tr",null,[n("th",{class:"text-center text-h6"},"\u7DE8\u865F"),n("th",{class:"text-center text-h6"},"\u5E33\u865F"),n("th",{class:"text-center text-h6"},"\u89D2\u8272"),n("th",{class:"text-center text-h6"},"\u59D3\u540D"),n("th",{class:"text-center text-h6"},"\u6027\u5225"),n("th",{class:"text-center text-h6"},"\u4FE1\u7BB1"),n("th",{class:"text-center text-h6"},"\u624B\u6A5F"),n("th",{class:"text-center text-h6"},"\u7DE8\u8F2F"),n("th",{class:"text-center text-h6"},"\u522A\u9664")])],-1),R={class:"text-center"},q={class:"text-center"},G={class:"text-center"},H={class:"text-center"},J={class:"text-center"},K={class:"text-center"},O={class:"text-center"},P=_("mdi-pencil-outline"),Q=_("mdi-delete"),W={key:1},X=n("td",{class:"text-center",colspan:"3"},"\u6C92\u6709\u6703\u54E1",-1),Y=[X],ee=_("mdi-close"),te=n("div",{class:"text-h5 font-weight-bold"},"\u7DE8\u8F2F\u6703\u54E1\u8CC7\u6599",-1),le=_("\u78BA\u5B9A"),se=_("\u53D6\u6D88"),be={__name:"UsersView",setup(ae){const d=c([]),w=c(["\u7BA1\u7406\u54E1","\u6703\u54E1"]),k=c(["\u7537","\u5973"]),e=c({_id:"",account:"",role:"",name:"",gender:"",email:"",phone:"",address:"",idx:-1,dialog:!1,valid:!1,submitting:!1}),h=c({account:[s=>!!s||"\u5E33\u865F\u5FC5\u586B",s=>s.length>=4&&s.length<=20||"\u5E33\u865F\u9577\u5EA6\u70BA 4 \u5230 20 \u500B\u5B57",s=>/^[a-zA-Z0-9]+$/.test(s)||"\u5E33\u865F\u53EA\u80FD\u7531\u82F1\u6578\u5B57\u7D44\u6210"],password:[s=>!!s||"\u5BC6\u78BC\u5FC5\u586B",s=>s.length>=4&&s.length<=20||"\u5BC6\u78BC\u9577\u5EA6\u70BA 4 \u5230 20 \u500B\u5B57",s=>/^[a-zA-Z0-9]+$/.test(s)||"\u5BC6\u78BC\u53EA\u80FD\u7531\u82F1\u6578\u5B57\u7D44\u6210"],email:[s=>!!s||"\u4FE1\u7BB1\u5FC5\u586B",s=>Z.exports.isEmail(s)||"\u4FE1\u7BB1\u683C\u5F0F\u932F\u8AA4"],name:[s=>s.length<=10||"\u540D\u5B57\u5FC5\u9808 10 \u500B\u5B57\u4EE5\u4E0B"],gender:[s=>!!s||"\u6027\u5225\u5FC5\u586B"]}),C=(s,t)=>{e._id=s,t>-1&&(e.account=d[t].account,e.role=d[t].role,e.name=d[t].name,e.gender=d[t].gender,e.email=d[t].email,e.phone=d[t].phone,e.address=d[t].address),e.idx=t,e.dialog=!0,e.valid=!1,e.submitting=!1},U=async()=>{if(!e.valid)return;e.submitting=!0;const s=new FormData;for(const t in e)["_id","idx","dialog","valid","submitting"].includes(t)||s.append(t,e[t]);try{if(e._id.length!==0){const{data:t}=await b.patch("/users/"+e._id,s);console.log(e._id),console.log(s.account),d[e.idx]=t.result,x.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(t){x.fire({icon:"error",title:"\u5931\u6557",text:t.isAxiosError?t.response.data.message:t.message})}e.submitting=!1};return(async()=>{try{const{data:s}=await b.get("/users/all");d.push(...s.result)}catch(s){console.log(s),x.fire({icon:"error",title:"\u5931\u6557",text:s.isAxiosError?s.response.data.message:s.message})}})(),(s,t)=>(g(),p("div",I,[l(u,{class:"justify-center"},{default:a(()=>[l(i,{cols:"9"},{default:a(()=>[L]),_:1}),l(i,{cols:"9"},{default:a(()=>[l(u,{class:"justify-end align-center",style:{height:"150px"}})]),_:1}),l(i,{cols:"9"},{default:a(()=>[l(E,null,{default:a(()=>[M,n("tbody",null,[d.length>0?(g(!0),p(j,{key:0},A(d,(o,y)=>(g(),p("tr",{key:o._id},[n("td",R,r(y+1),1),n("td",q,r(o.account),1),n("td",G,r(o.role),1),n("td",H,r(o.name),1),n("td",J,r(o.gender),1),n("td",K,r(o.email),1),n("td",O,r(o.phone),1),n("td",null,[l(u,{class:"justify-center align-center"},{default:a(()=>[l(m,{onClick:ne=>C(o._id,y),style:{width:"2rem",height:"2rem"},icon:"",variant:"text"},{default:a(()=>[l(V,{style:{"font-size":"large"},color:"blue lighten-2"},{default:a(()=>[P]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),n("td",null,[l(u,{class:"justify-center align-center"},{default:a(()=>[l(m,{style:{width:"2rem",height:"2rem"},icon:"",variant:"text"},{default:a(()=>[l(V,{style:{"font-size":"large"},color:"red lighten-2"},{default:a(()=>[Q]),_:1})]),_:1})]),_:1})])]))),128)):(g(),p("tr",W,Y))])]),_:1})]),_:1})]),_:1}),l(z,{modelValue:e.dialog,"onUpdate:modelValue":t[10]||(t[10]=o=>e.dialog=o),persistent:""},{default:a(()=>[l(N,{modelValue:e.valid,"onUpdate:modelValue":t[9]||(t[9]=o=>e.valid=o),onSubmit:F(U,["prevent"])},{default:a(()=>[l(T,null,{default:a(()=>[l(i,{class:"d-flex justify-end"},{default:a(()=>[l(m,{icon:"",variant:"text",size:"x-small",onClick:t[0]||(t[0]=o=>e.dialog=!1)},{default:a(()=>[l(V,null,{default:a(()=>[ee]),_:1})]),_:1})]),_:1}),l($,{class:"text-center my-2"},{default:a(()=>[te]),_:1}),l(B,null,{default:a(()=>[l(S,null,{default:a(()=>[l(u,{class:"justify-center"},{default:a(()=>[l(i,{cols:"10"},{default:a(()=>[l(f,{type:"text",label:"\u5E33\u865F",modelValue:e.account,"onUpdate:modelValue":t[1]||(t[1]=o=>e.account=o),rules:h.account,counter:"20",maxlength:"20"},null,8,["modelValue","rules"])]),_:1}),l(i,{cols:"10"},{default:a(()=>[l(v,{type:"text",label:"\u89D2\u8272",items:w,modelValue:e.role,"onUpdate:modelValue":t[2]||(t[2]=o=>e.role=o)},null,8,["items","modelValue"])]),_:1}),l(i,{cols:"10"},{default:a(()=>[l(f,{type:"text",label:"\u59D3\u540D",modelValue:e.name,"onUpdate:modelValue":t[3]||(t[3]=o=>e.name=o),counter:"10",maxlength:"10"},null,8,["modelValue"])]),_:1}),l(i,{cols:"10"},{default:a(()=>[l(v,{type:"text",label:"\u6027\u5225",items:k,modelValue:e.gender,"onUpdate:modelValue":t[4]||(t[4]=o=>e.gender=o),rules:h.gender},null,8,["items","modelValue","rules"])]),_:1}),l(i,{cols:"10"},{default:a(()=>[l(f,{type:"email",label:"\u4FE1\u7BB1",modelValue:e.email,"onUpdate:modelValue":t[5]||(t[5]=o=>e.email=o),rules:h.email,counter:"20",maxlength:"20"},null,8,["modelValue","rules"])]),_:1}),l(i,{cols:"10"},{default:a(()=>[l(f,{type:"text",label:"\u624B\u6A5F",modelValue:e.phone,"onUpdate:modelValue":t[6]||(t[6]=o=>e.phone=o),counter:"10",maxlength:"10"},null,8,["modelValue"])]),_:1}),l(i,{cols:"10"},{default:a(()=>[l(f,{type:"text",label:"\u5730\u5740",modelValue:e.address,"onUpdate:modelValue":t[7]||(t[7]=o=>e.address=o),counter:"50",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(D,null,{default:a(()=>[l(u,{class:"justify-center"},{default:a(()=>[l(m,{type:"submit",color:"primary",loading:e.submitting},{default:a(()=>[le]),_:1},8,["loading"]),l(m,{color:"error",onClick:t[8]||(t[8]=o=>e.dialog=!1),disabled:e.submitting},{default:a(()=>[se]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1},8,["modelValue"])]))}};export{be as default};
